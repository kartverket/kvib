import{j as f}from"./jsx-runtime-DgHZ7iq2.js";import{e as x,m as I,a as h,f as se,h as le,j as ue}from"./factory-C8pPPz6n.js";import{r as E}from"./index-C7I6S4tq.js";import{m as ce}from"./factory-CpD2hwoa.js";import{c as ge}from"./create-slot-recipe-context-KvBbDfRP.js";import{g as be,b as ve,r as V,k as Y,h as F,l as X,j as _,m as fe,c as Ee,o as pe,p as g,q as L,s as me,t as he}from"./create-context-B_OvqDKw.js";import{c as Ce,a as K}from"./create-split-props-L-tVc3XO.js";import{a as N,f as $,i as Pe,c as Ie,u as ye,b as R,d as Te,n as we}from"./use-event-DluRpvc7.js";import{u as Oe}from"./use-environment-context-CwI7sxJj.js";import{u as H}from"./use-field-context-B739sAKC.js";function Se(e){const r={each(t){var i;for(let n=0;n<((i=e.frames)==null?void 0:i.length);n+=1){const o=e.frames[n];o&&t(o)}},addEventListener(t,i,n){return r.each(o=>{try{o.document.addEventListener(t,i,n)}catch{}}),()=>{try{r.removeEventListener(t,i,n)}catch{}}},removeEventListener(t,i,n){r.each(o=>{try{o.document.removeEventListener(t,i,n)}catch{}})}};return r}function Ve(e){const r=e.frameElement!=null?e.parent:null;return{addEventListener:(t,i,n)=>{try{r==null||r.addEventListener(t,i,n)}catch{}return()=>{try{r==null||r.removeEventListener(t,i,n)}catch{}}},removeEventListener:(t,i,n)=>{try{r==null||r.removeEventListener(t,i,n)}catch{}}}}var j="pointerdown.outside",B="focus.outside";function ke(e){for(const r of e)if(X(r)&&Y(r))return!0;return!1}var z=e=>"clientY"in e;function Le(e,r){if(!z(r)||!e)return!1;const t=e.getBoundingClientRect();return t.width===0||t.height===0?!1:t.top<=r.clientY&&r.clientY<=t.top+t.height&&t.left<=r.clientX&&r.clientX<=t.left+t.width}function U(e,r){if(!r||!z(e))return!1;const i=r.scrollHeight>r.clientHeight&&e.clientX>r.clientWidth,o=r.scrollWidth>r.clientWidth&&e.clientY>r.clientHeight;return i||o}function Re(e,r){const{exclude:t,onFocusOutside:i,onPointerDownOutside:n,onInteractOutside:o,defer:b}=r;if(!e)return;const l=be(e),T=ve(e),c=Se(T),w=Ve(T);function C(d){const u=F(d);if(!X(u)||_(e,u)||Le(e,d)||U(d,u))return!1;const v=fe(e);return U(d,v)?!1:!(t!=null&&t(u))}const p=new Set;function O(d){function u(){var M;const v=b?V:A=>A(),D=((M=d.composedPath)==null?void 0:M.call(d))??[d.target];v(()=>{if(!(!e||!C(d))){if(n||o){const A=x(n,o);e.addEventListener(j,A,{once:!0})}$(e,j,{bubbles:!1,cancelable:!0,detail:{originalEvent:d,contextmenu:Pe(d),focusable:ke(D)}})}})}d.pointerType==="touch"?(p.forEach(v=>v()),p.add(N(l,"click",u,{once:!0})),p.add(w.addEventListener("click",u,{once:!0})),p.add(c.addEventListener("click",u,{once:!0}))):u()}const m=new Set,s=setTimeout(()=>{m.add(N(l,"pointerdown",O,!0)),m.add(w.addEventListener("pointerdown",O,!0)),m.add(c.addEventListener("pointerdown",O,!0))},0);function k(d){(b?V:v=>v())(()=>{if(!(!e||!C(d))){if(i||o){const v=x(i,o);e.addEventListener(B,v,{once:!0})}$(e,B,{bubbles:!1,cancelable:!0,detail:{originalEvent:d,contextmenu:!1,focusable:Y(F(d))}})}})}return m.add(N(l,"focusin",k,!0)),m.add(w.addEventListener("focusin",k,!0)),m.add(c.addEventListener("focusin",k,!0)),()=>{clearTimeout(s),p.forEach(d=>d()),m.forEach(d=>d())}}function Ae(e,r){const{defer:t}=r,i=t?V:o=>o(),n=[];return n.push(i(()=>{const o=typeof e=="function"?e():e;n.push(Re(o,r))})),()=>{n.forEach(o=>o==null?void 0:o())}}const[G,y]=Ee({name:"EditableContext",hookName:"useEditableContext",providerName:"<EditableProvider />"}),J=E.forwardRef((e,r)=>{const t=y(),i=I(t.getAreaProps(),e);return f.jsx(h.div,{...i,ref:r})});J.displayName="EditableArea";const Q=E.forwardRef((e,r)=>{const t=y(),i=I(t.getCancelTriggerProps(),e);return f.jsx(h.button,{...i,ref:r})});Q.displayName="EditableCancelTrigger";const Ne=e=>e.children(y()),Z=E.forwardRef((e,r)=>{const t=y(),i=I(t.getControlProps(),e);return f.jsx(h.div,{...i,ref:r})});Z.displayName="EditableControl";const ee=E.forwardRef((e,r)=>{const t=y(),i=I(t.getEditTriggerProps(),e);return f.jsx(h.button,{...i,ref:r})});ee.displayName="EditableEditTrigger";const te=E.forwardRef((e,r)=>{const t=y(),i=I(t.getInputProps(),e),n=H();return f.jsx(h.input,{"aria-describedby":n==null?void 0:n.ariaDescribedby,...i,ref:r})});te.displayName="EditableInput";const re=E.forwardRef((e,r)=>{const t=y(),i=I(t.getPreviewProps(),e);return f.jsx(h.span,{...i,ref:r})});re.displayName="EditablePreview";var De=Ce("editable").parts("root","area","label","preview","input","editTrigger","submitTrigger","cancelTrigger","control"),P=De.build(),a=pe({getRootId:e=>{var r;return((r=e.ids)==null?void 0:r.root)??`editable:${e.id}`},getAreaId:e=>{var r;return((r=e.ids)==null?void 0:r.area)??`editable:${e.id}:area`},getLabelId:e=>{var r;return((r=e.ids)==null?void 0:r.label)??`editable:${e.id}:label`},getPreviewId:e=>{var r;return((r=e.ids)==null?void 0:r.preview)??`editable:${e.id}:preview`},getInputId:e=>{var r;return((r=e.ids)==null?void 0:r.input)??`editable:${e.id}:input`},getControlId:e=>{var r;return((r=e.ids)==null?void 0:r.control)??`editable:${e.id}:control`},getSubmitTriggerId:e=>{var r;return((r=e.ids)==null?void 0:r.submitTrigger)??`editable:${e.id}:submit`},getCancelTriggerId:e=>{var r;return((r=e.ids)==null?void 0:r.cancelTrigger)??`editable:${e.id}:cancel`},getEditTriggerId:e=>{var r;return((r=e.ids)==null?void 0:r.editTrigger)??`editable:${e.id}:edit`},getInputEl:e=>a.getById(e,a.getInputId(e)),getPreviewEl:e=>a.getById(e,a.getPreviewId(e)),getSubmitTriggerEl:e=>a.getById(e,a.getSubmitTriggerId(e)),getCancelTriggerEl:e=>a.getById(e,a.getCancelTriggerId(e)),getEditTriggerEl:e=>a.getById(e,a.getEditTriggerId(e))});function Me(e,r,t){const i=e.context.disabled,n=e.context.isInteractive,o=e.context.readOnly,b=e.context.invalid,l=e.context.autoResize,T=e.context.translations,c=e.matches("edit"),w=e.context.placeholder,C=typeof w=="string"?{edit:w,preview:w}:w,p=e.context.value,O=p.trim()==="",m=O?(C==null?void 0:C.preview)??"":p;return{editing:c,empty:O,value:p,valueText:m,setValue(s){r({type:"VALUE.SET",value:s,src:"setValue"})},clearValue(){r({type:"VALUE.SET",value:"",src:"clearValue"})},edit(){n&&r("EDIT")},cancel(){n&&r("CANCEL")},submit(){n&&r("SUBMIT")},getRootProps(){return t.element({...P.root.attrs,id:a.getRootId(e.context),dir:e.context.dir})},getAreaProps(){return t.element({...P.area.attrs,id:a.getAreaId(e.context),dir:e.context.dir,style:l?{display:"inline-grid"}:void 0,"data-focus":g(c),"data-disabled":g(i),"data-placeholder-shown":g(O)})},getLabelProps(){return t.label({...P.label.attrs,id:a.getLabelId(e.context),dir:e.context.dir,htmlFor:a.getInputId(e.context),"data-focus":g(c),"data-invalid":g(b),onClick(){if(c)return;const s=a.getPreviewEl(e.context);s==null||s.focus({preventScroll:!0})}})},getInputProps(){return t.input({...P.input.attrs,dir:e.context.dir,"aria-label":T.input,name:e.context.name,form:e.context.form,id:a.getInputId(e.context),hidden:l?void 0:!c,placeholder:C==null?void 0:C.edit,maxLength:e.context.maxLength,required:e.context.required,disabled:i,"data-disabled":g(i),readOnly:o,"data-readonly":g(o),"aria-invalid":L(b),"data-invalid":g(b),"data-autoresize":g(l),defaultValue:p,size:l?1:void 0,onChange(s){r({type:"VALUE.SET",src:"input.change",value:s.currentTarget.value})},onKeyDown(s){if(s.defaultPrevented||me(s))return;const d={Escape(){r("CANCEL"),s.preventDefault()},Enter(u){if(!e.context.submitOnEnter)return;const{localName:v}=u.currentTarget;if(v==="textarea"){if(!(he()?u.metaKey:u.ctrlKey))return;r({type:"SUBMIT",src:"keydown.enter"});return}v==="input"&&!u.shiftKey&&!u.metaKey&&(r({type:"SUBMIT",src:"keydown.enter"}),u.preventDefault())}}[s.key];d&&d(s)},style:l?{gridArea:"1 / 1 / auto / auto",visibility:c?void 0:"hidden"}:void 0})},getPreviewProps(){return t.element({id:a.getPreviewId(e.context),...P.preview.attrs,dir:e.context.dir,"data-placeholder-shown":g(O),"aria-readonly":L(o),"data-readonly":g(i),"data-disabled":g(i),"aria-disabled":L(i),"aria-invalid":L(b),"data-invalid":g(b),"aria-label":T.edit,"data-autoresize":g(l),children:m,hidden:l?void 0:c,tabIndex:n?0:void 0,onClick(){n&&e.context.activationMode==="click"&&r({type:"EDIT",src:"click"})},onFocus(){n&&e.context.activationMode==="focus"&&r({type:"EDIT",src:"focus"})},onDoubleClick(s){s.defaultPrevented||n&&e.context.activationMode==="dblclick"&&r({type:"EDIT",src:"dblclick"})},style:l?{whiteSpace:"pre",userSelect:"none",gridArea:"1 / 1 / auto / auto",visibility:c?"hidden":void 0,overflow:"hidden",textOverflow:"ellipsis"}:void 0})},getEditTriggerProps(){return t.button({...P.editTrigger.attrs,id:a.getEditTriggerId(e.context),dir:e.context.dir,"aria-label":T.edit,hidden:c,type:"button",disabled:i,onClick(s){s.defaultPrevented||n&&r({type:"EDIT",src:"edit.click"})}})},getControlProps(){return t.element({id:a.getControlId(e.context),...P.control.attrs,dir:e.context.dir})},getSubmitTriggerProps(){return t.button({...P.submitTrigger.attrs,dir:e.context.dir,id:a.getSubmitTriggerId(e.context),"aria-label":T.submit,hidden:!c,disabled:i,type:"button",onClick(s){s.defaultPrevented||n&&r({type:"SUBMIT",src:"submit.click"})}})},getCancelTriggerProps(){return t.button({...P.cancelTrigger.attrs,dir:e.context.dir,"aria-label":T.cancel,id:a.getCancelTriggerId(e.context),hidden:!c,type:"button",disabled:i,onClick(s){s.defaultPrevented||n&&r({type:"CANCEL",src:"cancel.click"})}})}}}var xe=e=>["both","enter"].includes(e.submitMode),W=e=>["both","blur"].includes(e.submitMode);function Fe(e){const r=se(e);return le({id:"editable",initial:r.edit?"edit":"preview",entry:r.edit?["focusInput"]:void 0,context:{activationMode:"focus",submitMode:"both",value:"",previousValue:"",selectOnFocus:!0,disabled:!1,readOnly:!1,...r,translations:{input:"editable input",edit:"edit",submit:"submit",cancel:"cancel",...r.translations}},watch:{value:["syncInputValue"],edit:["toggleEditing"]},computed:{submitOnEnter:xe,submitOnBlur:W,isInteractive:t=>!(t.disabled||t.readOnly)},on:{"VALUE.SET":{actions:"setValue"}},states:{preview:{entry:["blurInputIfNeeded"],on:{"CONTROLLED.EDIT":{target:"edit",actions:["setPreviousValue","focusInput"]},EDIT:[{guard:"isEditControlled",actions:["invokeOnEdit"]},{target:"edit",actions:["setPreviousValue","focusInput","invokeOnEdit"]}]}},edit:{activities:["trackInteractOutside"],on:{"CONTROLLED.PREVIEW":[{guard:"isSubmitEvent",target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel"]}],CANCEL:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel","invokeOnPreview"]}],SUBMIT:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit","invokeOnPreview"]}]}}}},{guards:{isEditControlled:t=>!!t["edit.controlled"],isSubmitEvent:(t,i)=>{var n;return((n=i.previousEvent)==null?void 0:n.type)==="SUBMIT"}},activities:{trackInteractOutside(t,i,{send:n}){return Ae(a.getInputEl(t),{exclude(o){return[a.getCancelTriggerEl(t),a.getSubmitTriggerEl(t)].some(l=>_(l,o))},onFocusOutside:t.onFocusOutside,onPointerDownOutside:t.onPointerDownOutside,onInteractOutside(o){var l;if((l=t.onInteractOutside)==null||l.call(t,o),o.defaultPrevented)return;const{focusable:b}=o.detail;n({type:W(t)?"SUBMIT":"CANCEL",src:"interact-outside",focusable:b})}})}},actions:{restoreFocus(t,i){i.focusable||V(()=>{var o;const n=((o=t.finalFocusEl)==null?void 0:o.call(t))??a.getEditTriggerEl(t);n==null||n.focus({preventScroll:!0})})},focusInput(t){V(()=>{const i=a.getInputEl(t);i&&(t.selectOnFocus?i.select():i.focus({preventScroll:!0}))})},invokeOnCancel(t){var i;(i=t.onValueRevert)==null||i.call(t,{value:t.previousValue})},invokeOnSubmit(t){var i;(i=t.onValueCommit)==null||i.call(t,{value:t.value})},invokeOnEdit(t){var i;(i=t.onEditChange)==null||i.call(t,{edit:!0})},invokeOnPreview(t){var i;(i=t.onEditChange)==null||i.call(t,{edit:!1})},toggleEditing(t,i,{send:n}){n({type:t.edit?"CONTROLLED.EDIT":"CONTROLLED.PREVIEW",previousEvent:i})},syncInputValue(t){ie.value(t)},setValue(t,i){const n=t.maxLength!=null?i.value.slice(0,t.maxLength):i.value;q.value(t,n)},setPreviousValue(t){t.previousValue=t.value},revertValue(t){q.value(t,t.previousValue)},blurInputIfNeeded(t){var i;(i=a.getInputEl(t))==null||i.blur()}}})}var ie={value:e=>{const r=a.getInputEl(e);a.setValue(r,e.value)}},$e={change(e){var r;(r=e.onValueChange)==null||r.call(e,{value:e.value}),ie.value(e)}},q={value(e,r){ue(e.value,r)||(e.value=r,$e.change(e))}};Ie()(["activationMode","autoResize","dir","disabled","finalFocusEl","form","getRootNode","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","edit","edit.controlled","submitMode","translations","value"]);const je=(e={})=>{const{getRootNode:r}=Oe(),{dir:t}=ye(),i=H(),n={id:E.useId(),ids:{label:i==null?void 0:i.ids.label,input:i==null?void 0:i.ids.control},dir:t,disabled:i==null?void 0:i.disabled,invalid:i==null?void 0:i.invalid,readOnly:i==null?void 0:i.readOnly,required:i==null?void 0:i.required,getRootNode:r,edit:e.defaultEdit,value:e.defaultValue,"edit.controlled":e.edit!==void 0,...e},o={...n,value:e.value,onValueChange:R(e.onValueChange,{sync:!0}),onEditChange:R(e.onEditChange),onValueCommit:R(e.onValueCommit),onValueRevert:R(e.onValueRevert)},[b,l]=Te(Fe(n),{context:o});return Me(b,l,we)},ne=E.forwardRef((e,r)=>{const[t,i]=K()(e,["activationMode","autoResize","defaultEdit","defaultValue","disabled","edit","finalFocusEl","form","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","submitMode","translations","value"]),n=je(t),o=I(n.getRootProps(),i);return f.jsx(G,{value:n,children:f.jsx(h.div,{...o,ref:r})})});ne.displayName="EditableRoot";const oe=E.forwardRef((e,r)=>{const[{value:t},i]=K()(e,["value"]),n=I(t.getRootProps(),i);return f.jsx(G,{value:t,children:f.jsx(h.div,{...n,ref:r})})});oe.displayName="EditableRootProvider";const ae=E.forwardRef((e,r)=>{const t=y(),i=I(t.getSubmitTriggerProps(),e);return f.jsx(h.button,{...i,ref:r})});ae.displayName="EditableSubmitTrigger";const{withProvider:de,withContext:S,useStyles:Qe,PropsProvider:Be}=ge({key:"editable"}),Ze=de(oe,"root",{forwardAsChild:!0}),et=de(ne,"root",{forwardAsChild:!0}),tt=Be,rt=S(re,"preview",{forwardAsChild:!0}),it=S(te,"input",{forwardAsChild:!0}),Ue=E.forwardRef(function(r,t){const i=y(),n=ce(i.getInputProps(),r);return f.jsx(h.textarea,{ref:t,...n})}),nt=S(Ue,"input",{forwardAsChild:!0}),ot=S(Z,"control",{forwardAsChild:!0}),at=S(J,"area",{forwardAsChild:!0}),dt=S(ee,"editTrigger",{forwardAsChild:!0}),st=S(ae,"submitTrigger",{forwardAsChild:!0}),lt=S(Q,"cancelTrigger",{forwardAsChild:!0}),ut=Ne;export{et as E,it as a,rt as b,De as c,at as d,lt as e,ut as f,ot as g,dt as h,tt as i,Ze as j,st as k,nt as l,y as m,Qe as n,Ae as t,je as u};
