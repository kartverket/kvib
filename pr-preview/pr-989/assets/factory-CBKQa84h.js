import{r as j}from"./index-Cjd7pOeM.js";var Ue=t=>Array.from(Array(t).keys()),He=t=>t[0],Xe=t=>t[t.length-1],Yt=(t,e)=>t.indexOf(e)!==-1,$t=(t,...e)=>t.concat(e),kt=(t,...e)=>t.filter(s=>!e.includes(s)),Je=(t,e)=>Yt(t,e)?kt(t,e):$t(t,e);function Gt(t){for(;t.length>0;)t.pop();return t}var ut=t=>(t==null?void 0:t.constructor.name)==="Array",qt=(t,e)=>{if(t.length!==e.length)return!1;for(let s=0;s<t.length;s++)if(!wt(t[s],e[s]))return!1;return!0},wt=(t,e)=>{if(Object.is(t,e))return!0;if(t==null&&e!=null||t!=null&&e==null)return!1;if(typeof(t==null?void 0:t.isEqual)=="function"&&typeof(e==null?void 0:e.isEqual)=="function")return t.isEqual(e);if(typeof t=="function"&&typeof e=="function")return t.toString()===e.toString();if(ut(t)&&ut(e))return qt(Array.from(t),Array.from(e));if(typeof t!="object"||typeof e!="object")return!1;const s=Object.keys(e??Object.create(null)),i=s.length;for(let r=0;r<i;r++)if(!Reflect.has(t,s[r]))return!1;for(let r=0;r<i;r++){const c=s[r];if(!wt(t[c],e[c]))return!1}return!0},ft=(t,...e)=>(typeof t=="function"?t(...e):t)??void 0,O=t=>t,Bt=()=>{},Ut=(...t)=>(...e)=>{t.forEach(function(s){s==null||s(...e)})},lt=(()=>{let t=0;return()=>(t++,t.toString(36))})(),Ht=(t,e)=>{var s;try{return t()}catch(i){return i instanceof Error&&((s=Error.captureStackTrace)==null||s.call(Error,i,Ht)),e==null?void 0:e()}},$=t=>Array.isArray(t),At=t=>t!=null&&typeof t=="object",z=t=>At(t)&&!$(t),Xt=t=>typeof t=="number"&&!Number.isNaN(t),w=t=>typeof t=="string",k=t=>typeof t=="function",Qe=t=>t==null,Ot=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),Jt=t=>Object.prototype.toString.call(t),Pt=Function.prototype.toString,Qt=Pt.call(Object),Zt=t=>{if(!At(t)||Jt(t)!="[object Object]")return!1;const e=Object.getPrototypeOf(t);if(e===null)return!0;const s=Ot(e,"constructor")&&e.constructor;return typeof s=="function"&&s instanceof s&&Pt.call(s)==Qt},{floor:tt,abs:G,round:B,min:te,max:ee,pow:se,sign:ne}=Math,C=t=>Number.isNaN(t),P=t=>C(t)?0:t,Ze=(t,e)=>(t%e+e)%e,ts=(t,e)=>(t%e+e)%e,ie=(t,e,s)=>t===0?s:e[t-1],re=(t,e,s)=>t===e.length-1?s:e[t+1],es=(t,e)=>P(t)>=e,ss=(t,e)=>P(t)<=e,ns=(t,e,s)=>P(t)>=e&&P(t)<=s,oe=(t,e,s)=>B((P(t)-e)/s)*s+e,ae=(t,e,s)=>te(ee(P(t),e),s),is=(t,e,s)=>(P(t)-e)/(s-e),rs=(t,e,s,i)=>ae(oe(t*(s-e)+e,e,i),e,s),F=(t,e)=>{let s=t,i=e.toString(),r=i.indexOf("."),c=r>=0?i.length-r:0;if(c>0){let f=se(10,c);s=B(s*f)/f}return s},os=(t,e)=>typeof e=="number"?tt(t*e+.5)/e:B(t),ce=(t,e,s,i)=>{e=Number(e),s=Number(s);let r=(t-(C(e)?0:e))%i,c=F(G(r)*2>=i?t+ne(r)*(i-G(r)):t-r,i);return C(e)?!C(s)&&c>s&&(c=e+tt(F((s-e)/i,i))*i):c<e?c=e:!C(s)&&c>s&&(c=e+tt(F((s-e)/i,i))*i),F(c,i)},he=(t,e,s)=>t[e]===s?t:[...t.slice(0,e),s,...t.slice(e+1)];function Rt(t,e){const s=ie(t,e.values,e.min),i=re(t,e.values,e.max);let r=e.values.slice();return function(f){let n=ce(f,s,i,e.step);return r=he(r,t,f),r[t]=n,r}}function as(t,e){const s=e.values[t]+e.step;return Rt(t,e)(s)}function cs(t,e){const s=e.values[t]-e.step;return Rt(t,e)(s)}var hs=(t,e)=>{let s=t.findIndex(c=>e-c<0);if(s===0)return s;if(s===-1)return t.length-1;let i=t[s-1],r=t[s];return G(i-e)<G(r-e)?s-1:s},us=(t,e,s,i)=>t.map((r,c)=>({min:c===0?e:t[c-1]+i,max:c===t.length-1?s:t[c+1]-i,value:r})),fs=(t,e)=>{const[s,i]=t,[r,c]=e;return f=>s===i||r===c?r:r+(c-r)/(i-s)*(f-s)},ls=(t,e=0,s=10)=>{const i=Math.pow(s,e);return B(t*i)/i},dt=t=>{if(!Number.isFinite(t))return 0;let e=1,s=0;for(;Math.round(t*e)/e!==t;)e*=10,s+=1;return s},bt=(t,e,s)=>{let i=e==="+"?t+s:t-s;if(t%1!==0||s%1!==0){const r=10**Math.max(dt(t),dt(s));t=Math.round(t*r),s=Math.round(s*r),i=e==="+"?t+s:t-s,i/=r}return i},ds=(t,e)=>bt(P(t),"+",e),ps=(t,e)=>bt(P(t),"-",e);function q(t){if(!ue(t)||t===void 0)return t;const e=Reflect.ownKeys(t).filter(i=>typeof i=="string"),s={};for(const i of e){const r=t[i];r!==void 0&&(s[i]=q(r))}return s}var ue=t=>t&&typeof t=="object"&&t.constructor===Object;function fe(t,e){const s={},i={},r=new Set(e);for(const c in t)r.has(c)?i[c]=t[c]:s[c]=t[c];return[i,s]}var gs=t=>function(s){return fe(s,t)};function J(...t){t.length===1?t[0]:t[1],t.length===2&&t[0]}function K(...t){t.length===1?t[0]:t[1],t.length===2&&t[0]}const le=Symbol(),rt=Symbol(),x="a",Mt="f",pt="p",Tt="c",_t="t",jt="h",Y="w",Dt="o",Nt="k";let de=(t,e)=>new Proxy(t,e);const et=Object.getPrototypeOf,st=new WeakMap,Vt=t=>t&&(st.has(t)?st.get(t):et(t)===Object.prototype||et(t)===Array.prototype),gt=t=>typeof t=="object"&&t!==null,pe=t=>Object.values(Object.getOwnPropertyDescriptors(t)).some(e=>!e.configurable&&!e.writable),ge=t=>{if(Array.isArray(t))return Array.from(t);const e=Object.getOwnPropertyDescriptors(t);return Object.values(e).forEach(s=>{s.configurable=!0}),Object.create(et(t),e)},ye=(t,e)=>{const s={[Mt]:e};let i=!1;const r=(n,a)=>{if(!i){let o=s[x].get(t);if(o||(o={},s[x].set(t,o)),n===Y)o[Y]=!0;else{let h=o[n];h||(h=new Set,o[n]=h),h.add(a)}}},c=()=>{i=!0,s[x].delete(t)},f={get(n,a){return a===rt?t:(r(Nt,a),ve(Reflect.get(n,a),s[x],s[Tt],s[_t]))},has(n,a){return a===le?(c(),!0):(r(jt,a),Reflect.has(n,a))},getOwnPropertyDescriptor(n,a){return r(Dt,a),Reflect.getOwnPropertyDescriptor(n,a)},ownKeys(n){return r(Y),Reflect.ownKeys(n)}};return e&&(f.set=f.deleteProperty=()=>!1),[f,s]},Ct=t=>t[rt]||t,ve=(t,e,s,i)=>{if(!Vt(t))return t;let r=i&&i.get(t);if(!r){const a=Ct(t);pe(a)?r=[a,ge(a)]:r=[a],i==null||i.set(t,r)}const[c,f]=r;let n=s&&s.get(c);return(!n||n[1][Mt]!==!!f)&&(n=ye(c,!!f),n[1][pt]=de(f||c,n[0]),s&&s.set(c,n)),n[1][x]=e,n[1][Tt]=s,n[1][_t]=i,n[1][pt]},me=(t,e)=>{const s=Reflect.ownKeys(t),i=Reflect.ownKeys(e);return s.length!==i.length||s.some((r,c)=>r!==i[c])},Ee=(t,e,s,i,r=Object.is)=>{if(r(t,e))return!1;if(!gt(t)||!gt(e))return!0;const c=s.get(Ct(t));if(!c)return!0;if(i){if(i.get(t)===e)return!1;i.set(t,e)}let f=null;for(const n of c[jt]||[])if(f=Reflect.has(t,n)!==Reflect.has(e,n),f)return f;if(c[Y]===!0){if(f=me(t,e),f)return f}else for(const n of c[Dt]||[]){const a=!!Reflect.getOwnPropertyDescriptor(t,n),o=!!Reflect.getOwnPropertyDescriptor(e,n);if(f=a!==o,f)return f}for(const n of c[Nt]||[])if(f=Ee(t[n],e[n],s,i,r),f)return f;if(f===null)throw new Error("invalid used");return f},Se=t=>Vt(t)&&t[rt]||null,yt=(t,e=!0)=>{st.set(t,e)};function we(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function xt(t,e){const s=we();return s?(s[t]||(s[t]=e()),s[t]):e()}var L=xt("__zag__refSet",()=>new WeakSet),Ae=t=>typeof t=="object"&&t!==null&&"$$typeof"in t&&"props"in t,Oe=t=>typeof t=="object"&&t!==null&&"__v_isVNode"in t,Pe=t=>typeof t=="object"&&t!==null&&"nodeType"in t&&typeof t.nodeName=="string",Re=t=>Ae(t)||Oe(t)||Pe(t),nt=t=>t!==null&&typeof t=="object",it=t=>nt(t)&&!L.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!Re(t)&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise);function vt(t,e,s){typeof s.value=="object"&&!it(s.value)&&(s.value=M(s.value)),!s.enumerable||s.get||s.set||!s.configurable||!s.writable||e==="__proto__"?Object.defineProperty(t,e,s):t[e]=s.value}function M(t){if(typeof t!="object")return t;var e=0,s,i,r,c=Object.prototype.toString.call(t);if(c==="[object Object]"?r=Object.create(Object.getPrototypeOf(t)||null):c==="[object Array]"?r=Array(t.length):c==="[object Set]"?(r=new Set,t.forEach(function(f){r.add(M(f))})):c==="[object Map]"?(r=new Map,t.forEach(function(f,n){r.set(M(n),M(f))})):c==="[object Date]"?r=new Date(+t):c==="[object RegExp]"?r=new RegExp(t.source,t.flags):c==="[object DataView]"?r=new t.constructor(M(t.buffer)):c==="[object ArrayBuffer]"?r=t.slice(0):c==="[object Blob]"?r=t.slice():c.slice(-6)==="Array]"&&(r=new t.constructor(t)),r){for(i=Object.getOwnPropertySymbols(t);e<i.length;e++)vt(r,i[e],Object.getOwnPropertyDescriptor(t,i[e]));for(e=0,i=Object.getOwnPropertyNames(t);e<i.length;e++)Object.hasOwnProperty.call(r,s=i[e])&&r[s]===t[s]||vt(r,s,Object.getOwnPropertyDescriptor(t,s))}return r||t}var b=xt("__zag__proxyStateMap",()=>new WeakMap),be=(t=Object.is,e=(n,a)=>new Proxy(n,a),s=new WeakMap,i=(n,a)=>{const o=s.get(n);if((o==null?void 0:o[0])===a)return o[1];const h=Array.isArray(n)?[]:Object.create(Object.getPrototypeOf(n));return yt(h,!0),s.set(n,[a,h]),Reflect.ownKeys(n).forEach(l=>{const d=Reflect.get(n,l);L.has(d)?(yt(d,!1),h[l]=d):b.has(d)?h[l]=D(d):h[l]=d}),Object.freeze(h)},r=new WeakMap,c=[1,1],f=n=>{if(!nt(n))throw new Error("object required");const a=r.get(n);if(a)return a;let o=c[0];const h=new Set,l=(v,p=++c[0])=>{o!==p&&(o=p,h.forEach(y=>y(v,p)))};let d=c[1];const g=(v=++c[1])=>(d!==v&&!h.size&&(d=v,E.forEach(([p])=>{const y=p[1](v);y>o&&(o=y)})),o),m=v=>(p,y)=>{const S=[...p];S[1]=[v,...S[1]],l(S,y)},E=new Map,T=(v,p)=>{if(h.size){const y=p[3](m(v));E.set(v,[p,y])}else E.set(v,[p])},H=v=>{var y;const p=E.get(v);p&&(E.delete(v),(y=p[1])==null||y.call(p))},at=v=>(h.add(v),h.size===1&&E.forEach(([y,S],_)=>{const N=y[3](m(_));E.set(_,[y,N])}),()=>{h.delete(v),h.size===0&&E.forEach(([y,S],_)=>{S&&(S(),E.set(_,[y]))})}),X=Array.isArray(n)?[]:Object.create(Object.getPrototypeOf(n)),W=e(X,{deleteProperty(v,p){const y=Reflect.get(v,p);H(p);const S=Reflect.deleteProperty(v,p);return S&&l(["delete",[p],y]),S},set(v,p,y,S){var ct;const _=Reflect.has(v,p),N=Reflect.get(v,p,S);if(_&&(t(N,y)||r.has(y)&&t(N,r.get(y))))return!0;H(p),nt(y)&&(y=Se(y)||y);let I=y;if(!((ct=Object.getOwnPropertyDescriptor(v,p))!=null&&ct.set)){!b.has(y)&&it(y)&&(I=ot(y));const ht=!L.has(I)&&b.get(I);ht&&T(p,ht)}return Reflect.set(v,p,I,S),l(["set",[p],y,N]),!0}});r.set(n,W);const Kt=[X,g,i,at];return b.set(W,Kt),Reflect.ownKeys(n).forEach(v=>{const p=Object.getOwnPropertyDescriptor(n,v);p.get||p.set?Object.defineProperty(X,v,p):W[v]=n[v]}),W})=>[f,b,L,t,e,it,s,i,r,c],[Me]=be();function ot(t={}){return Me(t)}function mt(t,e,s){const i=b.get(t);let r;const c=[],f=i[3];let n=!1;const o=f(h=>{if(c.push(h),s){e(c.splice(0));return}r||(r=Promise.resolve().then(()=>{r=void 0,n&&e(c.splice(0))}))});return n=!0,()=>{n=!1,o()}}function D(t){const e=b.get(t),[s,i,r]=e;return r(s,i())}function Et(t){return L.add(t),t}function Te(t,e){Object.keys(e).forEach(r=>{if(Object.getOwnPropertyDescriptor(t,r))throw new Error("object property already defined");const c=e[r],{get:f,set:n}=typeof c=="function"?{get:c}:c,a={};a.get=()=>f(D(i)),n&&(a.set=o=>n(i,o)),Object.defineProperty(t,r,a)});const i=ot(t);return i}var _e=Object.defineProperty,je=(t,e,s)=>e in t?_e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,u=(t,e,s)=>je(t,typeof e!="symbol"?e+"":e,s);function Lt(t,...e){for(const s of e){const i=q(s);for(const r in i)Zt(s[r])?(t[r]||(t[r]={}),Lt(t[r],s[r])):t[r]=s[r]}return t}function A(t){return w(t)?{type:t}:t}function R(t){return t?$(t)?t.slice():[t]:[]}function Wt(t){return z(t)&&t.predicate!=null}var It=()=>!0;function U(t,e,s,i){return r=>{var c;return w(r)?!!((c=t[r])!=null&&c.call(t,e,s,i)):k(r)?r(e,s,i):r.predicate(t)(e,s,i)}}function De(...t){return{predicate:e=>(s,i,r)=>t.map(U(e,s,i,r)).some(Boolean)}}function Ne(...t){return{predicate:e=>(s,i,r)=>t.map(U(e,s,i,r)).every(Boolean)}}function Ve(t){return{predicate:e=>(s,i,r)=>!U(e,s,i,r)(t)}}function Ce(...t){return(e,s,i)=>i.state.matches(...t)}var ys={or:De,and:Ne,not:Ve,stateIn:Ce};function vs(t){return{predicate:e=>(s,i,r)=>{var c;return(c=t.find(f=>{const n=f.guard??It;return U(e,s,i,r)(n)}))==null?void 0:c.actions}}}function Ft(t,e){return t=t??It,(s,i,r)=>{if(w(t)){const c=e[t];return k(c)?c(s,i,r):c}return Wt(t)?t.predicate(e)(s,i,r):t==null?void 0:t(s,i,r)}}function Q(t,e){return(s,i,r)=>Wt(t)?t.predicate(e)(s,i,r):t}function xe(t){var c,f;const e=t.computed??O({}),s=t.context??O({}),i=t.initial?(f=(c=t.states)==null?void 0:c[t.initial])==null?void 0:f.tags:[],r=ot({value:t.initial??"",previousValue:"",event:O({}),previousEvent:O({}),context:Te(s,e),done:!1,tags:i??[],hasTag(n){return this.tags.includes(n)},matches(...n){return n.includes(this.value)},can(n){return O(this).nextEvents.includes(n)},get nextEvents(){var o,h;const n=((h=(o=t.states)==null?void 0:o[this.value])==null?void 0:h.on)??{},a=(t==null?void 0:t.on)??{};return Object.keys({...n,...a})},get changed(){return this.event.value==="machine.init"||!this.previousValue?!1:this.value!==this.previousValue}});return O(r)}function V(t,e){return(s,i)=>{if(Xt(t))return t;if(k(t))return t(s,i);if(w(t)){const r=Number.parseFloat(t);if(!Number.isNaN(r))return r;if(e){const c=e==null?void 0:e[t];return K(c==null,`[@zag-js/core > determine-delay] Cannot determine delay for \`${t}\`. It doesn't exist in \`options.delays\``),k(c)?c(s,i):c}}}}function Le(t){return w(t)?{target:t}:t}function We(t,e){return(s,i,r)=>R(t).map(Le).find(c=>Ft(c.guard,e)(s,i,r)??c.target??c.actions)}var zt=class{constructor(t,e){var s,i,r,c,f;u(this,"status","Not Started"),u(this,"state"),u(this,"initialState"),u(this,"initialContext"),u(this,"id"),u(this,"type","machine"),u(this,"activityEvents",new Map),u(this,"delayedEvents",new Map),u(this,"stateListeners",new Set),u(this,"doneListeners",new Set),u(this,"contextWatchers",new Set),u(this,"removeStateListener",Bt),u(this,"parent"),u(this,"children",new Map),u(this,"guardMap"),u(this,"actionMap"),u(this,"delayMap"),u(this,"activityMap"),u(this,"sync"),u(this,"options"),u(this,"config"),u(this,"_created",()=>{if(!this.config.created)return;const n=A("machine.created");this.executeActions(this.config.created,n)}),u(this,"start",n=>{if(this.state.value="",this.state.tags=[],this.status==="Running")return this;this.status="Running",this.removeStateListener=mt(this.state,()=>{this.stateListeners.forEach(g=>{g(this.stateSnapshot)})},this.sync),this.setupContextWatchers(),this.executeActivities(A("machine.start"),R(this.config.activities),"machine.start"),this.executeActions(this.config.entry,A("machine.start"));const a=A("machine.init"),o=z(n)?n.value:n,h=z(n)?n.context:void 0;h&&this.setContext(h);const l={target:o??this.config.initial},d=this.getNextStateInfo(l,a);return this.initialState=d,this.performStateChangeEffects(this.state.value,d,a),this}),u(this,"setupContextWatchers",()=>{const{watch:n}=this.config;if(!n)return;let a=D(this.state.context);const o=mt(this.state.context,()=>{var l;const h=D(this.state.context);for(const[d,g]of Object.entries(n))(((l=this.options.compareFns)==null?void 0:l[d])??Object.is)(a[d],h[d])||this.executeActions(g,this.state.event);a=h});this.contextWatchers.add(o)}),u(this,"stop",()=>{if(this.status!=="Stopped")return this.performExitEffects(this.state.value,A("machine.stop")),this.executeActions(this.config.exit,A("machine.stop")),this.setState(""),this.setEvent("machine.stop"),this.stopStateListeners(),this.stopChildren(),this.stopActivities(),this.stopDelayedEvents(),this.stopContextWatchers(),this.status="Stopped",this}),u(this,"stopStateListeners",()=>{this.removeStateListener(),this.stateListeners.clear()}),u(this,"stopContextWatchers",()=>{this.contextWatchers.forEach(n=>n()),this.contextWatchers.clear()}),u(this,"stopDelayedEvents",()=>{this.delayedEvents.forEach(n=>{n.forEach(a=>a())}),this.delayedEvents.clear()}),u(this,"stopActivities",n=>{var a,o;n?((a=this.activityEvents.get(n))==null||a.forEach(h=>h()),(o=this.activityEvents.get(n))==null||o.clear(),this.activityEvents.delete(n)):(this.activityEvents.forEach(h=>{h.forEach(l=>l()),h.clear()}),this.activityEvents.clear())}),u(this,"sendChild",(n,a)=>{const o=A(n),h=ft(a,this.contextSnapshot),l=this.children.get(h);l||K(`[@zag-js/core] Cannot send '${o.type}' event to unknown child`),l.send(o)}),u(this,"stopChild",n=>{this.children.has(n)||K(`[@zag-js/core > stop-child] Cannot stop unknown child ${n}`),this.children.get(n).stop(),this.children.delete(n)}),u(this,"removeChild",n=>{this.children.delete(n)}),u(this,"stopChildren",()=>{this.children.forEach(n=>n.stop()),this.children.clear()}),u(this,"setParent",n=>{this.parent=n}),u(this,"spawn",(n,a)=>{const o=ft(n);return a&&(o.id=a),o.type="machine.actor",o.setParent(this),this.children.set(o.id,O(o)),o.onDone(()=>{this.removeChild(o.id)}).start(),O(Et(o))}),u(this,"stopActivity",n=>{var o;if(!this.state.value)return;const a=this.activityEvents.get(this.state.value);(o=a==null?void 0:a.get(n))==null||o(),a==null||a.delete(n)}),u(this,"addActivityCleanup",(n,a,o)=>{var h;n&&(this.activityEvents.has(n)?(h=this.activityEvents.get(n))==null||h.set(a,o):this.activityEvents.set(n,new Map([[a,o]])))}),u(this,"setState",n=>{this.state.previousValue=this.state.value,this.state.value=n;const a=this.getStateNode(n);n==null?Gt(this.state.tags):this.state.tags=R(a==null?void 0:a.tags)}),u(this,"setContext",n=>{n&&Lt(this.state.context,q(n))}),u(this,"setOptions",n=>{const a=q(n);this.actionMap={...this.actionMap,...a.actions},this.delayMap={...this.delayMap,...a.delays},this.activityMap={...this.activityMap,...a.activities},this.guardMap={...this.guardMap,...a.guards}}),u(this,"getStateNode",n=>{var a;if(n)return(a=this.config.states)==null?void 0:a[n]}),u(this,"getNextStateInfo",(n,a)=>{const o=this.determineTransition(n,a),h=!(o!=null&&o.target),l=(o==null?void 0:o.target)??this.state.value,d=this.state.value!==l,g=this.getStateNode(l),E={reenter:!h&&!d&&!(o!=null&&o.internal),transition:o,stateNode:g,target:l,changed:d};return this.log("NextState:",`[${a.type}]`,this.state.value,"---->",E.target),E}),u(this,"getAfterActions",(n,a)=>{let o;const h=this.state.value;return{entry:()=>{o=globalThis.setTimeout(()=>{const l=this.getNextStateInfo(n,this.state.event);this.performStateChangeEffects(h,l,this.state.event)},a)},exit:()=>{globalThis.clearTimeout(o)}}}),u(this,"getDelayedEventActions",n=>{const a=this.getStateNode(n),o=this.state.event;if(!a||!a.after)return;const h=[],l=[];if($(a.after)){const d=this.determineTransition(a.after,o);if(!d)return;if(!Ot(d,"delay"))throw new Error(`[@zag-js/core > after] Delay is required for after transition: ${JSON.stringify(d)}`);const m=V(d.delay,this.delayMap)(this.contextSnapshot,o),E=this.getAfterActions(d,m);return h.push(E.entry),l.push(E.exit),{entries:h,exits:l}}if(z(a.after))for(const d in a.after){const g=a.after[d],E=V(d,this.delayMap)(this.contextSnapshot,o),T=this.getAfterActions(g,E);h.push(T.entry),l.push(T.exit)}return{entries:h,exits:l}}),u(this,"executeActions",(n,a)=>{var h;const o=Q(n,this.guardMap)(this.contextSnapshot,a,this.guardMeta);for(const l of R(o)){const d=w(l)?(h=this.actionMap)==null?void 0:h[l]:l;J(w(l)&&!d,`[@zag-js/core > execute-actions] No implementation found for action: \`${l}\``),d==null||d(this.state.context,a,this.meta)}}),u(this,"executeActivities",(n,a,o)=>{var h;for(const l of a){const d=w(l)?(h=this.activityMap)==null?void 0:h[l]:l;if(!d){J(`[@zag-js/core > execute-activity] No implementation found for activity: \`${l}\``);continue}const g=d(this.state.context,n,this.meta);if(g){const m=w(l)?l:l.name||lt();this.addActivityCleanup(o??this.state.value,m,g)}}}),u(this,"createEveryActivities",(n,a)=>{if(n)if($(n)){const o=R(n).find(g=>{const m=g.delay,T=V(m,this.delayMap)(this.contextSnapshot,this.state.event);return Ft(g.guard,this.guardMap)(this.contextSnapshot,this.state.event,this.guardMeta)??T!=null});if(!o)return;const l=V(o.delay,this.delayMap)(this.contextSnapshot,this.state.event);a(()=>{const g=globalThis.setInterval(()=>{this.executeActions(o.actions,this.state.event)},l);return()=>{globalThis.clearInterval(g)}})}else for(const o in n){const h=n==null?void 0:n[o],d=V(o,this.delayMap)(this.contextSnapshot,this.state.event);a(()=>{const m=globalThis.setInterval(()=>{this.executeActions(h,this.state.event)},d);return()=>{globalThis.clearInterval(m)}})}}),u(this,"setEvent",n=>{this.state.previousEvent=this.state.event,this.state.event=Et(A(n))}),u(this,"performExitEffects",(n,a)=>{const o=this.state.value;if(o==="")return;const h=n?this.getStateNode(n):void 0;this.stopActivities(o);const l=Q(h==null?void 0:h.exit,this.guardMap)(this.contextSnapshot,a,this.guardMeta),d=R(l),g=this.delayedEvents.get(o);g&&d.push(...g),this.executeActions(d,a),this.delayedEvents.delete(o)}),u(this,"performEntryEffects",(n,a)=>{const o=this.getStateNode(n),h=R(o==null?void 0:o.activities);this.createEveryActivities(o==null?void 0:o.every,m=>{h.unshift(m)}),h.length>0&&this.executeActivities(a,h);const l=Q(o==null?void 0:o.entry,this.guardMap)(this.contextSnapshot,a,this.guardMeta),d=R(l),g=this.getDelayedEventActions(n);o!=null&&o.after&&g&&(this.delayedEvents.set(n,g==null?void 0:g.exits),d.push(...g.entries)),this.executeActions(d,a),(o==null?void 0:o.type)==="final"&&(this.state.done=!0,this.doneListeners.forEach(m=>{m(this.stateSnapshot)}),this.stop())}),u(this,"performTransitionEffects",(n,a)=>{const o=this.determineTransition(n,a);this.executeActions(o==null?void 0:o.actions,a)}),u(this,"performStateChangeEffects",(n,a,o)=>{this.setEvent(o);const h=a.changed||a.reenter;h&&this.performExitEffects(n,o),this.performTransitionEffects(a.transition,o),this.setState(a.target),h&&this.performEntryEffects(a.target,o)}),u(this,"determineTransition",(n,a)=>{const o=We(n,this.guardMap);return o==null?void 0:o(this.contextSnapshot,a,this.guardMeta)}),u(this,"sendParent",n=>{var o;this.parent||K("[@zag-js/core > send-parent] Cannot send event to an unknown parent");const a=A(n);(o=this.parent)==null||o.send(a)}),u(this,"log",(...n)=>{}),u(this,"send",n=>{const a=A(n);this.transition(this.state.value,a)}),u(this,"transition",(n,a)=>{var g,m;const o=w(n)?this.getStateNode(n):n==null?void 0:n.stateNode,h=A(a);if(!o&&!this.config.on){const E=this.status==="Stopped"?"[@zag-js/core > transition] Cannot transition a stopped machine":`[@zag-js/core > transition] State does not have a definition for \`state\`: ${n}, \`event\`: ${h.type}`;J(E);return}const l=((g=o==null?void 0:o.on)==null?void 0:g[h.type])??((m=this.config.on)==null?void 0:m[h.type]),d=this.getNextStateInfo(l,h);return this.performStateChangeEffects(this.state.value,d,h),d.stateNode}),u(this,"subscribe",n=>(this.stateListeners.add(n),this.status==="Running"&&n(this.stateSnapshot),()=>{this.stateListeners.delete(n)})),u(this,"onDone",n=>(this.doneListeners.add(n),this)),u(this,"onTransition",n=>(this.stateListeners.add(n),this.status==="Running"&&n(this.stateSnapshot),this)),this.config=M(t),this.options=M(e??{}),this.id=this.config.id??`machine-${lt()}`,this.guardMap=((s=this.options)==null?void 0:s.guards)??{},this.actionMap=((i=this.options)==null?void 0:i.actions)??{},this.delayMap=((r=this.options)==null?void 0:r.delays)??{},this.activityMap=((c=this.options)==null?void 0:c.activities)??{},this.sync=((f=this.options)==null?void 0:f.sync)??!1,this.state=xe(this.config),this.initialContext=D(this.state.context)}get stateSnapshot(){return O(D(this.state))}getState(){return this.stateSnapshot}get contextSnapshot(){return this.stateSnapshot.context}get self(){const t=this;return{id:this.id,send:this.send.bind(this),sendParent:this.sendParent.bind(this),sendChild:this.sendChild.bind(this),stop:this.stop.bind(this),stopChild:this.stopChild.bind(this),spawn:this.spawn.bind(this),stopActivity:this.stopActivity.bind(this),get state(){return t.stateSnapshot},get initialContext(){return t.initialContext},get initialState(){var e;return((e=t.initialState)==null?void 0:e.target)??""}}}get meta(){var t;return{state:this.stateSnapshot,guards:this.guardMap,send:this.send.bind(this),self:this.self,initialContext:this.initialContext,initialState:((t=this.initialState)==null?void 0:t.target)??"",getState:()=>this.stateSnapshot,getAction:e=>this.actionMap[e],getGuard:e=>this.guardMap[e]}}get guardMeta(){return{state:this.stateSnapshot}}get[Symbol.toStringTag](){return"Machine"}getHydrationState(){const t=this.getState();return{value:t.value,tags:t.tags}}},ms=(t,e)=>new zt(t,e),Es=t=>t instanceof zt||(t==null?void 0:t.type)==="machine",Ie=(...t)=>t.map(e=>{var s;return(s=e==null?void 0:e.trim)==null?void 0:s.call(e)}).filter(Boolean).join(" "),Fe=/((?:--)?(?:\w+-?)+)\s*:\s*([^;]*)/g,St=t=>{const e={};let s;for(;s=Fe.exec(t);)e[s[1]]=s[2];return e},ze=(t,e)=>{if(w(t)){if(w(e))return`${t};${e}`;t=St(t)}else w(e)&&(e=St(e));return Object.assign({},t??{},e??{})};function Ke(...t){let e={};for(let s of t){for(let i in e){if(i.startsWith("on")&&typeof e[i]=="function"&&typeof s[i]=="function"){e[i]=Ut(s[i],e[i]);continue}if(i==="className"||i==="class"){e[i]=Ie(e[i],s[i]);continue}if(i==="style"){e[i]=ze(e[i],s[i]);continue}e[i]=s[i]!==void 0?s[i]:e[i]}for(let i in s)e[i]===void 0&&(e[i]=s[i])}return e}function Ye(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function $e(...t){return e=>{for(const s of t)Ye(s,e)}}function ke(t){var i,r;let e=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,s=e&&"isReactWarning"in e&&e.isReactWarning;return s?t.ref:(e=(r=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:r.get,s=e&&"isReactWarning"in e&&e.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}const Z=t=>{const e=j.memo(j.forwardRef((s,i)=>{const{asChild:r,children:c,...f}=s;if(!r)return j.createElement(t,{...f,ref:i},c);const n=j.Children.only(c);if(!j.isValidElement(n))return null;const a=ke(n);return j.cloneElement(n,{...Ke(f,n.props),ref:i?$e(i,a):a})}));return e.displayName=t.displayName||t.name,e},Ge=()=>{const t=new Map;return new Proxy(Z,{apply(e,s,i){return Z(i[0])},get(e,s){const i=s;return t.has(i)||t.set(i,Z(i)),t.get(i)}})},Ss=Ge();export{Es as $,Bt as A,Qe as B,ft as C,k as D,Ht as E,O as F,w as G,z as H,Ot as I,Je as J,us as K,cs as L,as as M,hs as N,fs as O,os as P,ts as Q,ss as R,es as S,ns as T,vs as U,ds as V,ps as W,K as X,Xt as Y,ot as Z,Ue as _,Ss as a,lt as a0,D as b,$e as c,ve as d,Ut as e,q as f,xt as g,ms as h,Ee as i,wt as j,He as k,Xe as l,Ke as m,ys as n,gs as o,kt as p,$t as q,Et as r,mt as s,ae as t,ls as u,Ze as v,J as w,is as x,rs as y,ce as z};
