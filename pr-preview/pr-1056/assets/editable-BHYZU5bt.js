import{j as v}from"./jsx-runtime-D_zvdyIk.js";import{m as w,a as y,d as ve}from"./factory-q8nNcEUp.js";import{r as h}from"./index-BQvhbVge.js";import{m as me}from"./factory-D1GN6RGf.js";import{c as he}from"./create-slot-recipe-context-CAi7jAA5.js";import{r as D,g as Pe,b as ye,i as we,L as $,M as B,q as U,k as W,N as _,O as Ce,P as z,z as Q,Q as Te,R as q,c as Ie,o as f,S as M,y as Oe,T as Le,U as Ve}from"./index-Ct-f3TY_.js";import{c as Re,a as G}from"./index-0TWAmYWa.js";import{c as Se,a as ke,u as xe,n as Ae}from"./index-7REH5UVY.js";import{u as Ne}from"./use-environment-context-DZYGLJZ6.js";import{u as J}from"./use-field-context-HlIqaYSR.js";function De(e){const t={each(r){var a;for(let i=0;i<((a=e.frames)==null?void 0:a.length);i+=1){const n=e.frames[i];n&&r(n)}},addEventListener(r,a,i){return t.each(n=>{try{n.document.addEventListener(r,a,i)}catch{}}),()=>{try{t.removeEventListener(r,a,i)}catch{}}},removeEventListener(r,a,i){t.each(n=>{try{n.document.removeEventListener(r,a,i)}catch{}})}};return t}function Me(e){const t=e.frameElement!=null?e.parent:null;return{addEventListener:(r,a,i)=>{try{t==null||t.addEventListener(r,a,i)}catch{}return()=>{try{t==null||t.removeEventListener(r,a,i)}catch{}}},removeEventListener:(r,a,i)=>{try{t==null||t.removeEventListener(r,a,i)}catch{}}}}var Y="pointerdown.outside",X="focus.outside";function Fe(e){for(const t of e)if(z(t)&&_(t))return!0;return!1}var Z=e=>"clientY"in e;function $e(e,t){if(!Z(t)||!e)return!1;const r=e.getBoundingClientRect();return r.width===0||r.height===0?!1:r.top<=t.clientY&&t.clientY<=r.top+r.height&&r.left<=t.clientX&&t.clientX<=r.left+r.width}function je(e,t){return e.y<=t.y&&t.y<=e.y+e.height&&e.x<=t.x&&t.x<=e.x+e.width}function H(e,t){if(!t||!Z(e))return!1;const r=t.scrollHeight>t.clientHeight,a=r&&e.clientX>t.offsetLeft+t.clientWidth,i=t.scrollWidth>t.clientWidth,n=i&&e.clientY>t.offsetTop+t.clientHeight,d={x:t.offsetLeft,y:t.offsetTop,width:t.clientWidth+(r?16:0),height:t.clientHeight+(i?16:0)},k={x:e.clientX,y:e.clientY};return je(d,k)?a||n:!1}function Be(e,t){const{exclude:r,onFocusOutside:a,onPointerDownOutside:i,onInteractOutside:n,defer:d,followControlledElements:k=!0}=t;if(!e)return;const g=Pe(e),E=ye(e),S=De(E),x=Me(E);function O(s,b){if(!z(b)||!b.isConnected||Q(e,b)||$e(e,s)||k&&Te(e,b))return!1;const o=g.querySelector(`[aria-controls="${e.id}"]`);if(o){const u=q(o);if(H(s,u))return!1}const R=q(e);return H(s,R)?!1:!(r!=null&&r(b))}const p=new Set,l=we(e==null?void 0:e.getRootNode());function c(s){function b(o){var A;const R=d&&!B()?D:N=>N(),u=o??s,P=((A=u==null?void 0:u.composedPath)==null?void 0:A.call(u))??[u==null?void 0:u.target];R(()=>{const N=l?P[0]:U(s);if(!(!e||!O(s,N))){if(i||n){const Ee=W(i,n);e.addEventListener(Y,Ee,{once:!0})}K(e,Y,{bubbles:!1,cancelable:!0,detail:{originalEvent:u,contextmenu:Ce(u),focusable:Fe(P),target:N}})}})}s.pointerType==="touch"?(p.forEach(o=>o()),p.add($(g,"click",b,{once:!0})),p.add(x.addEventListener("click",b,{once:!0})),p.add(S.addEventListener("click",b,{once:!0}))):b()}const m=new Set,L=setTimeout(()=>{m.add($(g,"pointerdown",c,!0)),m.add(x.addEventListener("pointerdown",c,!0)),m.add(S.addEventListener("pointerdown",c,!0))},0);function V(s){(d?D:o=>o())(()=>{var u;const o=((u=s==null?void 0:s.composedPath)==null?void 0:u.call(s))??[s==null?void 0:s.target],R=l?o[0]:U(s);if(!(!e||!O(s,R))){if(a||n){const P=W(a,n);e.addEventListener(X,P,{once:!0})}K(e,X,{bubbles:!1,cancelable:!0,detail:{originalEvent:s,contextmenu:!1,focusable:_(R),target:R}})}})}return B()||(m.add($(g,"focusin",V,!0)),m.add(x.addEventListener("focusin",V,!0)),m.add(S.addEventListener("focusin",V,!0))),()=>{clearTimeout(L),p.forEach(s=>s()),m.forEach(s=>s())}}function Ue(e,t){const{defer:r}=t,a=r?D:n=>n(),i=[];return i.push(a(()=>{const n=typeof e=="function"?e():e;i.push(Be(n,t))})),()=>{i.forEach(n=>n==null?void 0:n())}}function K(e,t,r){const a=e.ownerDocument.defaultView||window,i=new a.CustomEvent(t,r);return e.dispatchEvent(i)}const[ee,C]=Ie({name:"EditableContext",hookName:"useEditableContext",providerName:"<EditableProvider />"}),te=h.forwardRef((e,t)=>{const r=C(),a=w(r.getAreaProps(),e);return v.jsx(y.div,{...a,ref:t})});te.displayName="EditableArea";const re=h.forwardRef((e,t)=>{const r=C(),a=w(r.getCancelTriggerProps(),e);return v.jsx(y.button,{...a,ref:t})});re.displayName="EditableCancelTrigger";const We=e=>e.children(C()),ie=h.forwardRef((e,t)=>{const r=C(),a=w(r.getControlProps(),e);return v.jsx(y.div,{...a,ref:t})});ie.displayName="EditableControl";const ae=h.forwardRef((e,t)=>{const r=C(),a=w(r.getEditTriggerProps(),e);return v.jsx(y.button,{...a,ref:t})});ae.displayName="EditableEditTrigger";const ne=h.forwardRef((e,t)=>{const r=C(),a=w(r.getInputProps(),e),i=J();return v.jsx(y.input,{"aria-describedby":i==null?void 0:i.ariaDescribedby,...a,ref:t})});ne.displayName="EditableInput";const oe=h.forwardRef((e,t)=>{const r=C(),a=w(r.getLabelProps(),e);return v.jsx(y.label,{...a,ref:t})});oe.displayName="EditableLabel";const se=h.forwardRef((e,t)=>{const r=C(),a=w(r.getPreviewProps(),e);return v.jsx(y.span,{...a,ref:t})});se.displayName="EditablePreview";var qe=Re("editable").parts("root","area","label","preview","input","editTrigger","submitTrigger","cancelTrigger","control"),T=qe.build(),Ye=e=>{var t;return((t=e.ids)==null?void 0:t.root)??`editable:${e.id}`},Xe=e=>{var t;return((t=e.ids)==null?void 0:t.area)??`editable:${e.id}:area`},He=e=>{var t;return((t=e.ids)==null?void 0:t.label)??`editable:${e.id}:label`},de=e=>{var t;return((t=e.ids)==null?void 0:t.preview)??`editable:${e.id}:preview`},j=e=>{var t;return((t=e.ids)==null?void 0:t.input)??`editable:${e.id}:input`},Ke=e=>{var t;return((t=e.ids)==null?void 0:t.control)??`editable:${e.id}:control`},le=e=>{var t;return((t=e.ids)==null?void 0:t.submitTrigger)??`editable:${e.id}:submit`},ue=e=>{var t;return((t=e.ids)==null?void 0:t.cancelTrigger)??`editable:${e.id}:cancel`},ce=e=>{var t;return((t=e.ids)==null?void 0:t.editTrigger)??`editable:${e.id}:edit`},F=e=>e.getById(j(e)),_e=e=>e.getById(de(e)),ze=e=>e.getById(le(e)),Qe=e=>e.getById(ue(e)),Ge=e=>e.getById(ce(e));function Je(e,t){const{state:r,context:a,send:i,prop:n,scope:d,computed:k}=e,g=!!n("disabled"),E=k("isInteractive"),S=!!n("readOnly"),x=!!n("required"),O=!!n("invalid"),p=!!n("autoResize"),l=n("translations"),c=r.matches("edit"),m=n("placeholder"),L=typeof m=="string"?{edit:m,preview:m}:m,V=a.get("value"),s=V.trim()==="",b=s?(L==null?void 0:L.preview)??"":V;return{editing:c,empty:s,value:V,valueText:b,setValue(o){i({type:"VALUE.SET",value:o,src:"setValue"})},clearValue(){i({type:"VALUE.SET",value:"",src:"clearValue"})},edit(){E&&i({type:"EDIT"})},cancel(){E&&i({type:"CANCEL"})},submit(){E&&i({type:"SUBMIT"})},getRootProps(){return t.element({...T.root.attrs,id:Ye(d),dir:n("dir")})},getAreaProps(){return t.element({...T.area.attrs,id:Xe(d),dir:n("dir"),style:p?{display:"inline-grid"}:void 0,"data-focus":f(c),"data-disabled":f(g),"data-placeholder-shown":f(s)})},getLabelProps(){return t.label({...T.label.attrs,id:He(d),dir:n("dir"),htmlFor:j(d),"data-focus":f(c),"data-invalid":f(O),"data-required":f(x),onClick(){if(c)return;const o=_e(d);o==null||o.focus({preventScroll:!0})}})},getInputProps(){return t.input({...T.input.attrs,dir:n("dir"),"aria-label":l==null?void 0:l.input,name:n("name"),form:n("form"),id:j(d),hidden:p?void 0:!c,placeholder:L==null?void 0:L.edit,maxLength:n("maxLength"),required:n("required"),disabled:g,"data-disabled":f(g),readOnly:S,"data-readonly":f(S),"aria-invalid":M(O),"data-invalid":f(O),"data-autoresize":f(p),defaultValue:V,size:p?1:void 0,onChange(o){i({type:"VALUE.SET",src:"input.change",value:o.currentTarget.value})},onKeyDown(o){if(o.defaultPrevented||Oe(o))return;const u={Escape(){i({type:"CANCEL"}),o.preventDefault()},Enter(P){if(!k("submitOnEnter"))return;const{localName:A}=P.currentTarget;if(A==="textarea"){if(!(Le()?P.metaKey:P.ctrlKey))return;i({type:"SUBMIT",src:"keydown.enter"});return}A==="input"&&!P.shiftKey&&!P.metaKey&&(i({type:"SUBMIT",src:"keydown.enter"}),P.preventDefault())}}[o.key];u&&u(o)},style:p?{gridArea:"1 / 1 / auto / auto",visibility:c?void 0:"hidden"}:void 0})},getPreviewProps(){return t.element({id:de(d),...T.preview.attrs,dir:n("dir"),"data-placeholder-shown":f(s),"aria-readonly":M(S),"data-readonly":f(g),"data-disabled":f(g),"aria-disabled":M(g),"aria-invalid":M(O),"data-invalid":f(O),"aria-label":l==null?void 0:l.edit,"data-autoresize":f(p),children:b,hidden:p?void 0:c,tabIndex:E?0:void 0,onClick(){E&&n("activationMode")==="click"&&i({type:"EDIT",src:"click"})},onFocus(){E&&n("activationMode")==="focus"&&i({type:"EDIT",src:"focus"})},onDoubleClick(o){o.defaultPrevented||E&&n("activationMode")==="dblclick"&&i({type:"EDIT",src:"dblclick"})},style:p?{whiteSpace:"pre",gridArea:"1 / 1 / auto / auto",visibility:c?"hidden":void 0,overflow:"hidden",textOverflow:"ellipsis"}:void 0})},getEditTriggerProps(){return t.button({...T.editTrigger.attrs,id:ce(d),dir:n("dir"),"aria-label":l==null?void 0:l.edit,hidden:c,type:"button",disabled:g,onClick(o){o.defaultPrevented||E&&i({type:"EDIT",src:"edit.click"})}})},getControlProps(){return t.element({id:Ke(d),...T.control.attrs,dir:n("dir")})},getSubmitTriggerProps(){return t.button({...T.submitTrigger.attrs,dir:n("dir"),id:le(d),"aria-label":l==null?void 0:l.submit,hidden:!c,disabled:g,type:"button",onClick(o){o.defaultPrevented||E&&i({type:"SUBMIT",src:"submit.click"})}})},getCancelTriggerProps(){return t.button({...T.cancelTrigger.attrs,dir:n("dir"),"aria-label":l==null?void 0:l.cancel,id:ue(d),hidden:!c,type:"button",disabled:g,onClick(o){o.defaultPrevented||E&&i({type:"CANCEL",src:"cancel.click"})}})}}}var Ze=ve({props({props:e}){return{activationMode:"focus",submitMode:"both",defaultValue:"",selectOnFocus:!0,...e,translations:{input:"editable input",edit:"edit",submit:"submit",cancel:"cancel",...e.translations}}},initialState({prop:e}){return e("edit")||e("defaultEdit")?"edit":"preview"},entry:["focusInputIfNeeded"],context:({bindable:e,prop:t})=>({value:e(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange(r){var a;return(a=t("onValueChange"))==null?void 0:a({value:r})}})),previousValue:e(()=>({defaultValue:""}))}),watch({track:e,action:t,context:r,prop:a}){e([()=>r.get("value")],()=>{t(["syncInputValue"])}),e([()=>a("edit")],()=>{t(["toggleEditing"])})},computed:{submitOnEnter({prop:e}){const t=e("submitMode");return t==="both"||t==="enter"},submitOnBlur({prop:e}){const t=e("submitMode");return t==="both"||t==="blur"},isInteractive({prop:e}){return!(e("disabled")||e("readOnly"))}},on:{"VALUE.SET":{actions:["setValue"]}},states:{preview:{entry:["blurInput"],on:{"CONTROLLED.EDIT":{target:"edit",actions:["setPreviousValue","focusInput"]},EDIT:[{guard:"isEditControlled",actions:["invokeOnEdit"]},{target:"edit",actions:["setPreviousValue","focusInput","invokeOnEdit"]}]}},edit:{effects:["trackInteractOutside"],entry:["syncInputValue"],on:{"CONTROLLED.PREVIEW":[{guard:"isSubmitEvent",target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel"]}],CANCEL:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel","invokeOnPreview"]}],SUBMIT:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit","invokeOnPreview"]}]}}},implementations:{guards:{isEditControlled:({prop:e})=>e("edit")!=null,isSubmitEvent:({event:e})=>{var t;return((t=e.previousEvent)==null?void 0:t.type)==="SUBMIT"}},effects:{trackInteractOutside({send:e,scope:t,prop:r,computed:a}){return Ue(F(t),{exclude(i){return[Qe(t),ze(t)].some(d=>Q(d,i))},onFocusOutside:r("onFocusOutside"),onPointerDownOutside:r("onPointerDownOutside"),onInteractOutside(i){var d;if((d=r("onInteractOutside"))==null||d(i),i.defaultPrevented)return;const{focusable:n}=i.detail;e({type:a("submitOnBlur")?"SUBMIT":"CANCEL",src:"interact-outside",focusable:n})}})}},actions:{restoreFocus({event:e,scope:t,prop:r}){e.focusable||D(()=>{var i;const a=((i=r("finalFocusEl"))==null?void 0:i())??Ge(t);a==null||a.focus({preventScroll:!0})})},clearValue({context:e}){e.set("value","")},focusInputIfNeeded({action:e,prop:t}){(t("edit")||t("defaultEdit"))&&e(["focusInput"])},focusInput({scope:e,prop:t}){D(()=>{const r=F(e);r&&(t("selectOnFocus")?r.select():r.focus({preventScroll:!0}))})},invokeOnCancel({prop:e,context:t}){var a;const r=t.get("previousValue");(a=e("onValueRevert"))==null||a({value:r})},invokeOnSubmit({prop:e,context:t}){var a;const r=t.get("value");(a=e("onValueCommit"))==null||a({value:r})},invokeOnEdit({prop:e}){var t;(t=e("onEditChange"))==null||t({edit:!0})},invokeOnPreview({prop:e}){var t;(t=e("onEditChange"))==null||t({edit:!1})},toggleEditing({prop:e,send:t,event:r}){t({type:e("edit")?"CONTROLLED.EDIT":"CONTROLLED.PREVIEW",previousEvent:r})},syncInputValue({context:e,scope:t}){const r=F(t);r&&Ve(r,e.get("value"))},setValue({context:e,prop:t,event:r}){const a=t("maxLength"),i=a!=null?r.value.slice(0,a):r.value;e.set("value",i)},setPreviousValue({context:e}){e.set("previousValue",e.get("value"))},revertValue({context:e}){const t=e.get("previousValue");t&&e.set("value",t)},blurInput({scope:e}){var t;(t=F(e))==null||t.blur()}}}});Se()(["activationMode","autoResize","dir","disabled","finalFocusEl","form","getRootNode","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","edit","defaultEdit","submitMode","translations","defaultValue","value"]);const et=e=>{const t=h.useId(),{getRootNode:r}=Ne(),{dir:a}=ke(),i=J(),n={id:t,ids:{label:i==null?void 0:i.ids.label,input:i==null?void 0:i.ids.control},dir:a,disabled:i==null?void 0:i.disabled,invalid:i==null?void 0:i.invalid,readOnly:i==null?void 0:i.readOnly,required:i==null?void 0:i.required,getRootNode:r,...e},d=xe(Ze,n);return Je(d,Ae)},tt=G(),fe=h.forwardRef((e,t)=>{const[r,a]=tt(e,["activationMode","autoResize","defaultEdit","defaultValue","disabled","edit","finalFocusEl","form","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","submitMode","translations","value"]),i=et(r),n=w(i.getRootProps(),a);return v.jsx(ee,{value:i,children:v.jsx(y.div,{...n,ref:t})})});fe.displayName="EditableRoot";const rt=G(),ge=h.forwardRef((e,t)=>{const[{value:r},a]=rt(e,["value"]),i=w(r.getRootProps(),a);return v.jsx(ee,{value:r,children:v.jsx(y.div,{...i,ref:t})})});ge.displayName="EditableRootProvider";const pe=h.forwardRef((e,t)=>{const r=C(),a=w(r.getSubmitTriggerProps(),e);return v.jsx(y.button,{...a,ref:t})});pe.displayName="EditableSubmitTrigger";const{withProvider:be,withContext:I,useStyles:bt,PropsProvider:it}=he({key:"editable"}),Et=be(ge,"root",{forwardAsChild:!0}),vt=be(fe,"root",{forwardAsChild:!0}),mt=it,ht=I(se,"preview",{forwardAsChild:!0}),Pt=I(oe,"label",{forwardAsChild:!0}),yt=I(ne,"input",{forwardAsChild:!0}),at=h.forwardRef(function(t,r){const a=C(),i=me(a.getInputProps(),t);return v.jsx(y.textarea,{ref:r,...i})}),wt=I(at,"input",{forwardAsChild:!0}),Ct=I(ie,"control",{forwardAsChild:!0}),Tt=I(te,"area",{forwardAsChild:!0}),It=I(ae,"editTrigger",{forwardAsChild:!0}),Ot=I(pe,"submitTrigger",{forwardAsChild:!0}),Lt=I(re,"cancelTrigger",{forwardAsChild:!0}),Vt=We;export{vt as E,ht as a,yt as b,qe as c,Tt as d,Lt as e,Vt as f,Ct as g,It as h,Pt as i,mt as j,Et as k,Ot as l,wt as m,C as n,et as o,Ue as t,bt as u};
