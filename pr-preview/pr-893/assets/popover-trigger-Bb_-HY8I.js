import{j as f}from"./extends-CwFRzn3r.js";import{r}from"./index-BwDkhjyp.js";import{u as be,c as _}from"./use-popper-DwNTykfS.js";import{u as xe}from"./use-disclosure-CdGn7wGE.js";import{a as Te,u as Re,b as we}from"./use-focus-effect-BY0uqI8l.js";import{u as ke}from"./use-focus-on-pointer-down-BI4L5zXl.js";import{u as Se}from"./use-outside-click-DJDnsvpj.js";import{l as Ee}from"./lazy-DLVTVQVU.js";import{m as T}from"./use-merge-refs-Bdxaq0s4.js";import{c as d,a as Fe}from"./call-all-DDzecCnU.js";import{a as Q}from"./focusable-crJ8ziAt.js";import{u as Oe}from"./use-theme-CBfqdygA.js";import{a as Ae,o as Me}from"./use-style-config-C4sZEIFb.js";import{r as Be,c as X}from"./factory-lWLPzty5.js";import{f as Y}from"./forward-ref-BWI-Phbn.js";import{m as De}from"./proxy-CQsau1XN.js";import{d as Ie}from"./define-styles-BSAHv3yx.js";import{c as je}from"./cx-BDMMs1jM.js";import{c as Z}from"./context-CBKykClo.js";const[He,M]=Z({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[Ne,_e]=Z({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `}),y={click:"click",hover:"hover"};function ze(t={}){const{closeOnBlur:o=!0,closeOnEsc:c=!0,initialFocusRef:m,id:v,returnFocusOnClose:a=!0,autoFocus:B=!0,arrowSize:C,arrowShadowColor:R,trigger:u=y.click,openDelay:w=200,closeDelay:k=200,isLazy:oe,lazyBehavior:re="unmount",computePositionOnMount:te,...ne}=t,{isOpen:s,onClose:p,onOpen:D,onToggle:z}=xe(t),[se,I]=r.useState(a);r.useEffect(()=>I(a),[a]);const j=r.useRef(null),b=r.useRef(null),g=r.useRef(null),x=r.useRef(!1),L=r.useRef(!1);s&&(L.current=!0);const[K,ie]=r.useState(!1),[V,ae]=r.useState(!1),ce=r.useId(),le=v??ce,[U,S,E,F]=["popover-trigger","popover-content","popover-header","popover-body"].map(e=>`${e}-${le}`),{referenceRef:O,getArrowProps:ue,getPopperProps:$,getArrowInnerProps:pe,forceUpdate:de}=be({...ne,enabled:s||!!te}),G=Te({isOpen:s,ref:g});ke({enabled:s,ref:b}),Re(g,{focusRef:b,visible:s,shouldFocus:se&&u===y.click}),we(g,{focusRef:m,visible:s,shouldFocus:B&&u===y.click}),Se({enabled:s&&o,ref:g,handler(e){var n;const i=((n=e.composedPath)==null?void 0:n.call(e)[0])??[e.target];A(b.current,i)||(i&&I(!Q(i)),p())}});const q=Ee({wasSelected:L.current,enabled:oe,mode:re,isSelected:G.present}),fe=r.useCallback((e={},i=null)=>{const n={...e,style:{...e.style,transformOrigin:_.transformOrigin.varRef,[_.arrowSize.var]:C?`${C}px`:void 0,[_.arrowShadowColor.var]:R},ref:T(g,i),children:q?e.children:null,id:S,tabIndex:-1,role:"dialog",onKeyDown:d(e.onKeyDown,l=>{l.nativeEvent.isComposing||c&&l.key==="Escape"&&(l.preventDefault(),l.stopPropagation(),p())}),onBlur:d(e.onBlur,l=>{const h=W(l),N=A(g.current,h),ye=A(b.current,h),Ce=!N&&!ye;h&&I(!Q(h)),s&&o&&Ce&&p()}),"aria-labelledby":K?E:void 0,"aria-describedby":V?F:void 0};return u===y.hover&&(n.role="tooltip",n.onMouseEnter=d(e.onMouseEnter,()=>{x.current=!0}),n.onMouseLeave=d(e.onMouseLeave,l=>{l.nativeEvent.relatedTarget!==null&&(x.current=!1,setTimeout(()=>p(),k))})),n},[q,S,K,E,V,F,u,c,p,s,o,k,R,C]),me=r.useCallback((e={},i=null)=>$({...e,style:{visibility:s?"visible":"hidden",...e.style}},i),[s,$]),ve=r.useCallback((e,i=null)=>({...e,ref:T(i,j,O)}),[j,O]),P=r.useRef(),H=r.useRef(),J=r.useCallback(e=>{j.current==null&&O(e)},[O]),ge=r.useCallback((e={},i=null)=>{const n={...e,ref:T(b,i,J),id:U,"aria-haspopup":"dialog","aria-expanded":s,"aria-controls":S};return u===y.click&&(n.onClick=d(e.onClick,z)),u===y.hover&&(n.onFocus=d(e.onFocus,()=>{P.current===void 0&&D()}),n.onBlur=d(e.onBlur,l=>{const h=W(l),N=!A(g.current,h);s&&o&&N&&p()}),n.onKeyDown=d(e.onKeyDown,l=>{l.key==="Escape"&&p()}),n.onMouseEnter=d(e.onMouseEnter,()=>{x.current=!0,P.current=window.setTimeout(()=>D(),w)}),n.onMouseLeave=d(e.onMouseLeave,()=>{x.current=!1,P.current&&(clearTimeout(P.current),P.current=void 0),H.current=window.setTimeout(()=>{x.current===!1&&p()},k)})),n},[U,s,S,u,J,z,D,o,p,w,k]);r.useEffect(()=>()=>{P.current&&clearTimeout(P.current),H.current&&clearTimeout(H.current)},[]);const Pe=r.useCallback((e={},i=null)=>({...e,id:E,ref:T(i,n=>{ie(!!n)})}),[E]),he=r.useCallback((e={},i=null)=>({...e,id:F,ref:T(i,n=>{ae(!!n)})}),[F]);return{forceUpdate:de,isOpen:s,onAnimationComplete:G.onComplete,onClose:p,getAnchorProps:ve,getArrowProps:ue,getArrowInnerProps:pe,getPopoverPositionerProps:me,getPopoverProps:fe,getTriggerProps:ge,getHeaderProps:Pe,getBodyProps:he}}function A(t,o){return t===o||(t==null?void 0:t.contains(o))}function W(t){const o=t.currentTarget.ownerDocument.activeElement;return t.relatedTarget??o}function Le(t){const o=Ae("Popover",t),{children:c,...m}=Me(t),v=Oe(),a=ze({...m,direction:v.direction});return f.jsx(He,{value:a,children:f.jsx(Ne,{value:o,children:Be(c,{isOpen:a.isOpen,onClose:a.onClose,forceUpdate:a.forceUpdate})})})}Le.displayName="Popover";function Ke(t){const o=r.Children.only(t.children),{getAnchorProps:c}=M();return f.jsx(f.Fragment,{children:r.cloneElement(o,c(o.props,o.ref))})}Ke.displayName="PopoverAnchor";function Ve(t){if(t)return{enter:{...t.enter,visibility:"visible"},exit:{...t.exit,transitionEnd:{visibility:"hidden"}}}}const Ue={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},$e=X(De.section),ee=Y(function(o,c){const{variants:m=Ue,...v}=o,{isOpen:a}=M();return f.jsx($e,{ref:c,variants:Ve(m),initial:!1,animate:a?"enter":"exit",...v})});ee.displayName="PopoverTransition";const Ge=Y(function(o,c){const{rootProps:m,motionProps:v,...a}=o,{getPopoverProps:B,getPopoverPositionerProps:C,onAnimationComplete:R}=M(),u=_e(),w=Ie({position:"relative",display:"flex",flexDirection:"column",...u.content});return f.jsx(X.div,{...C(m),__css:u.popper,className:"chakra-popover__popper",children:f.jsx(ee,{...v,...B(a,c),onAnimationComplete:Fe(R,a.onAnimationComplete),className:je("chakra-popover__content",o.className),__css:w})})});Ge.displayName="PopoverContent";function qe(t){const o=r.Children.only(t.children),{getTriggerProps:c}=M();return f.jsx(f.Fragment,{children:r.cloneElement(o,c(o.props,o.ref))})}qe.displayName="PopoverTrigger";export{Le as P,_e as a,qe as b,Ge as c,Ke as d,M as u};
