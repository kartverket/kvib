import{a as q}from"./index-Ctx6eFvH.js";import{r as o,e as C}from"./index-CcKhGcwW.js";import"./index-DI5DFbIx.js";import"./jsx-runtime-sfY7k0Xq.js";import{s as R,t as v,u as d,v as A,x as O}from"./index-DussGwo5.js";var B=q(t=>t),E=t=>(t==null?void 0:t.constructor.name)==="Array",M=(t,e)=>{if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!l(t[r],e[r]))return!1;return!0},l=(t,e)=>{if(Object.is(t,e))return!0;if(t==null&&e!=null||t!=null&&e==null)return!1;if(typeof(t==null?void 0:t.isEqual)=="function"&&typeof(e==null?void 0:e.isEqual)=="function")return t.isEqual(e);if(typeof t=="function"&&typeof e=="function")return t.toString()===e.toString();if(E(t)&&E(e))return M(Array.from(t),Array.from(e));if(typeof t!="object"||typeof e!="object")return!1;const r=Object.keys(e??Object.create(null)),s=r.length;for(let n=0;n<s;n++)if(!Reflect.has(t,r[n]))return!1;for(let n=0;n<s;n++){const c=r[n];if(!l(t[c],e[c]))return!1}return!0},j=Function.prototype.toString;j.call(Object);function g(t){if(!w(t)||t===void 0)return t;const e=Reflect.ownKeys(t).filter(s=>typeof s=="string"),r={};for(const s of e){const n=t[s];n!==void 0&&(r[s]=g(n))}return r}var w=t=>t&&typeof t=="object"&&t.constructor===Object;function _(t,e){const r=o.useRef(!1),s=o.useRef(!1);o.useEffect(()=>{if(r.current&&s.current)return t();s.current=!0},e),o.useEffect(()=>(r.current=!0,()=>{r.current=!1}),[])}var{use:S}=C,W=R("__zag__targetCache",()=>new WeakMap);function x(t,e){const{actions:r,context:s,sync:n}=e??{},c=o.useRef(),u=o.useRef(),p=o.useSyncExternalStore(o.useCallback(f=>v(t.state,f,n),[n]),()=>{const f=d(t.state,S);try{if(c.current&&u.current&&!A(c.current,f,u.current,new WeakMap))return c.current}catch{}return f},()=>d(t.state,S));t.setOptions({actions:r});const i=o.useMemo(()=>g(s??{}),[s]);_(()=>{const f=Object.entries(i),h=t.contextSnapshot??{};f.map(([a,m])=>({key:a,curr:m,prev:h[a],equal:l(h[a],m)})).every(({equal:a})=>a)||t.setContext(i)},[i]);const y=new WeakMap;o.useEffect(()=>{c.current=p,u.current=y});const k=o.useMemo(()=>new WeakMap,[]);return O(p,y,k,W)}function D(t){return[x(t),t.send]}function z(t){const e=o.useRef();return e.current||(e.current={v:t()}),e.current.v}var K=typeof document<"u"?o.useLayoutEffect:o.useEffect;function L(t,e){const{state:r,context:s}=e??{},n=z(()=>{const u=typeof t=="function"?t():t;return s&&u.setContext(s),u._created(),u}),c=o.useRef();return K(()=>{const u=r??c.current;return n.start(u),()=>{n.stop()}},[]),n}function H(t,e){const r=L(t,e);return[x(r,e),r.send,r]}export{D as a,B as n,H as u};
