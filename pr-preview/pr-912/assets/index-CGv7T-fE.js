import{c as F}from"./index-BRNWFSEf.js";import{g as x,i as T,a as L}from"./index-3UVeZ5B9.js";import{c as b,q as C,d as i,v as P,a as N,g as S,i as U,r as f}from"./index-C5caIrke.js";import{i as R,c as O,a as B,b as H,d as m}from"./index-Cq1GvU5P.js";import{d as w}from"./index-NfPDfnaY.js";var $=F("pinInput").parts("root","label","input","control"),V=$.build(),a=b({getRootId:t=>{var u;return((u=t.ids)==null?void 0:u.root)??`pin-input:${t.id}`},getInputId:(t,u)=>{var e,n;return((n=(e=t.ids)==null?void 0:e.input)==null?void 0:n.call(e,u))??`pin-input:${t.id}:${u}`},getHiddenInputId:t=>{var u;return((u=t.ids)==null?void 0:u.hiddenInput)??`pin-input:${t.id}:hidden`},getLabelId:t=>{var u;return((u=t.ids)==null?void 0:u.label)??`pin-input:${t.id}:label`},getControlId:t=>{var u;return((u=t.ids)==null?void 0:u.control)??`pin-input:${t.id}:control`},getRootEl:t=>a.getById(t,a.getRootId(t)),getInputEls:t=>{const e=`input[data-ownedby=${CSS.escape(a.getRootId(t))}]`;return C(a.getRootEl(t),e)},getInputEl:(t,u)=>a.getById(t,a.getInputId(t,u)),getFocusedInputEl:t=>a.getInputEls(t)[t.focusedIndex],getFirstInputEl:t=>a.getInputEls(t)[0],getHiddenInputEl:t=>a.getById(t,a.getHiddenInputId(t))}),k={numeric:/^[0-9]+$/,alphabetic:/^[A-Za-z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/i};function D(t,u){var e;return t.type?!!((e=k[t.type])!=null&&e.test(u)):!0}function M(t,u){return t.pattern?new RegExp(t.pattern,"g").test(u):D(t,u)}function Z(t,u,e){const n=t.context.isValueComplete,o=t.context.invalid,I=t.context.focusedIndex,v=t.context.translations;function g(){var d;(d=a.getFirstInputEl(t.context))==null||d.focus()}return{focus:g,value:t.context.value,valueAsString:t.context.valueAsString,complete:n,setValue(d){Array.isArray(d)||R("[pin-input/setValue] value must be an array"),u({type:"VALUE.SET",value:d})},clearValue(){u({type:"VALUE.CLEAR"})},setValueAtIndex(d,r){u({type:"VALUE.SET",value:r,index:d})},getRootProps(){return e.element({dir:t.context.dir,...V.root.attrs,id:a.getRootId(t.context),"data-invalid":i(o),"data-disabled":i(t.context.disabled),"data-complete":i(n),"data-readonly":i(t.context.readOnly)})},getLabelProps(){return e.label({...V.label.attrs,dir:t.context.dir,htmlFor:a.getHiddenInputId(t.context),id:a.getLabelId(t.context),"data-invalid":i(o),"data-disabled":i(t.context.disabled),"data-complete":i(n),"data-readonly":i(t.context.readOnly),onClick(d){d.preventDefault(),g()}})},getHiddenInputProps(){return e.input({"aria-hidden":!0,type:"text",tabIndex:-1,id:a.getHiddenInputId(t.context),readOnly:t.context.readOnly,disabled:t.context.disabled,required:t.context.required,name:t.context.name,form:t.context.form,style:P,maxLength:t.context.valueLength,defaultValue:t.context.valueAsString})},getControlProps(){return e.element({...V.control.attrs,dir:t.context.dir,id:a.getControlId(t.context)})},getInputProps(d){const{index:r}=d,h=t.context.type==="numeric"?"tel":"text";return e.input({...V.input.attrs,dir:t.context.dir,disabled:t.context.disabled,"data-disabled":i(t.context.disabled),"data-complete":i(n),id:a.getInputId(t.context,r.toString()),"data-ownedby":a.getRootId(t.context),"aria-label":v.inputLabel(r,t.context.valueLength),inputMode:t.context.otp||t.context.type==="numeric"?"numeric":"text","aria-invalid":N(o),"data-invalid":i(o),type:t.context.mask?"password":h,defaultValue:t.context.value[r]||"",readOnly:t.context.readOnly,autoCapitalize:"none",autoComplete:t.context.otp?"one-time-code":"off",placeholder:I===r?"":t.context.placeholder,onBeforeInput(l){try{const c=S(l);M(t.context,c)||(u({type:"VALUE.INVALID",value:c}),l.preventDefault()),c.length>2&&l.currentTarget.setSelectionRange(0,1,"forward")}catch{}},onChange(l){const c=x(l),{value:s}=l.currentTarget;if(c.inputType==="insertFromPaste"||s.length>2){u({type:"INPUT.PASTE",value:s}),l.currentTarget.value=s[0],l.preventDefault();return}if(c.inputType==="deleteContentBackward"){u("INPUT.BACKSPACE");return}u({type:"INPUT.CHANGE",value:s,index:r})},onKeyDown(l){if(l.defaultPrevented||U(l)||T(l))return;const s={Backspace(){u("INPUT.BACKSPACE")},Delete(){u("INPUT.DELETE")},ArrowLeft(){u("INPUT.ARROW_LEFT")},ArrowRight(){u("INPUT.ARROW_RIGHT")},Enter(){u("INPUT.ENTER")}}[L(l,t.context)];s&&(s(l),l.preventDefault())},onFocus(){u({type:"INPUT.FOCUS",index:r})},onBlur(){u({type:"INPUT.BLUR",index:r})}})}}}function j(t){const u=O(t);return B({id:"pin-input",initial:"idle",context:{value:[],placeholder:"â—‹",otp:!1,type:"numeric",...u,focusedIndex:-1,translations:{inputLabel:(e,n)=>`pin code ${e+1} of ${n}`,...u.translations}},computed:{valueLength:e=>e.value.length,filledValueLength:e=>e.value.filter(n=>(n==null?void 0:n.trim())!=="").length,isValueComplete:e=>e.valueLength===e.filledValueLength,valueAsString:e=>e.value.join(""),focusedValue:e=>e.value[e.focusedIndex]||""},entry:H([{guard:"autoFocus",actions:["setupValue","setFocusIndexToFirst"]},{actions:["setupValue"]}]),watch:{focusedIndex:["focusInput","selectInputIfNeeded"],value:["syncInputElements"],isValueComplete:["invokeOnComplete","blurFocusedInputIfNeeded"]},on:{"VALUE.SET":[{guard:"hasIndex",actions:["setValueAtIndex"]},{actions:["setValue"]}],"VALUE.CLEAR":{actions:["clearValue","setFocusIndexToFirst"]}},states:{idle:{on:{"INPUT.FOCUS":{target:"focused",actions:"setFocusedIndex"}}},focused:{on:{"INPUT.CHANGE":[{guard:"isFinalValue",actions:["setFocusedValue","syncInputValue"]},{actions:["setFocusedValue","setNextFocusedIndex","syncInputValue"]}],"INPUT.PASTE":{actions:["setPastedValue","setLastValueFocusIndex"]},"INPUT.BLUR":{target:"idle",actions:"clearFocusedIndex"},"INPUT.DELETE":{guard:"hasValue",actions:"clearFocusedValue"},"INPUT.ARROW_LEFT":{actions:"setPrevFocusedIndex"},"INPUT.ARROW_RIGHT":{actions:"setNextFocusedIndex"},"INPUT.BACKSPACE":[{guard:"hasValue",actions:["clearFocusedValue"]},{actions:["setPrevFocusedIndex","clearFocusedValue"]}],"INPUT.ENTER":{guard:"isValueComplete",actions:"requestFormSubmit"},"VALUE.INVALID":{actions:"invokeOnInvalid"}}}}},{guards:{autoFocus:e=>!!e.autoFocus,isValueEmpty:(e,n)=>n.value==="",hasValue:e=>e.value[e.focusedIndex]!=="",isValueComplete:e=>e.isValueComplete,isFinalValue:e=>e.filledValueLength+1===e.valueLength&&e.value.findIndex(n=>n.trim()==="")===e.focusedIndex,hasIndex:(e,n)=>n.index!==void 0,isDisabled:e=>!!e.disabled},actions:{setupValue(e){if(e.value.length)return;const n=a.getInputEls(e),o=Array.from({length:n.length}).fill("");A(e,o)},focusInput(e){var n;e.focusedIndex!==-1&&((n=a.getFocusedInputEl(e))==null||n.focus({preventScroll:!0}))},selectInputIfNeeded(e){!e.selectOnFocus||e.focusedIndex===-1||f(()=>{var n;(n=a.getFocusedInputEl(e))==null||n.select()})},invokeOnComplete(e){var n;e.isValueComplete&&((n=e.onValueComplete)==null||n.call(e,{value:Array.from(e.value),valueAsString:e.valueAsString}))},invokeOnInvalid(e,n){var o;(o=e.onValueInvalid)==null||o.call(e,{value:n.value,index:e.focusedIndex})},clearFocusedIndex(e){e.focusedIndex=-1},setFocusedIndex(e,n){e.focusedIndex=n.index},setValue(e,n){p.value(e,n.value)},setFocusedValue(e,n){const o=E(e.focusedValue,n.value);p.valueAtIndex(e,e.focusedIndex,o)},revertInputValue(e){const n=a.getFocusedInputEl(e);a.setValue(n,e.focusedValue)},syncInputValue(e,n){const o=a.getInputEl(e,n.index.toString());a.setValue(o,e.value[n.index])},syncInputElements(e){a.getInputEls(e).forEach((o,I)=>{a.setValue(o,e.value[I])})},setPastedValue(e,n){f(()=>{const o=Math.min(e.focusedIndex,e.filledValueLength),I=o>0?e.valueAsString.substring(0,e.focusedIndex):"",v=n.value.substring(0,e.valueLength-o),g=I+v;p.value(e,g.split(""))})},setValueAtIndex(e,n){const o=E(e.focusedValue,n.value);p.valueAtIndex(e,n.index,o)},clearValue(e){const n=Array.from({length:e.valueLength}).fill("");p.value(e,n)},clearFocusedValue(e){p.valueAtIndex(e,e.focusedIndex,"")},setFocusIndexToFirst(e){e.focusedIndex=0},setNextFocusedIndex(e){e.focusedIndex=Math.min(e.focusedIndex+1,e.valueLength-1)},setPrevFocusedIndex(e){e.focusedIndex=Math.max(e.focusedIndex-1,0)},setLastValueFocusIndex(e){f(()=>{e.focusedIndex=Math.min(e.filledValueLength,e.valueLength-1)})},blurFocusedInputIfNeeded(e){e.blurOnComplete&&f(()=>{var n;(n=a.getFocusedInputEl(e))==null||n.blur()})},requestFormSubmit(e){var o;if(!e.name||!e.isValueComplete)return;const n=a.getHiddenInputEl(e);(o=n==null?void 0:n.form)==null||o.requestSubmit()}}})}function A(t,u){(Array.isArray(u)?u:u.split("").filter(Boolean)).forEach((n,o)=>{t.value[o]=n})}function E(t,u){let e=u;return t[0]===u[0]?e=u[1]:t[0]===u[1]&&(e=u[0]),e.split("")[e.length-1]}var y={change(t){var e;(e=t.onValueChange)==null||e.call(t,{value:Array.from(t.value),valueAsString:t.valueAsString});const u=a.getHiddenInputEl(t);w(u,{value:t.valueAsString})}},p={value(t,u){m(t.value,u)||(A(t,u),y.change(t))},valueAtIndex(t,u,e){m(t.value[u],e)||(t.value[u]=e,y.change(t))}};export{$ as a,Z as c,j as m};
