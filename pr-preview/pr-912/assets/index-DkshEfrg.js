var Pe=t=>Array.from(Array(t).keys()),be=t=>t[0],Re=t=>t[t.length-1],Nt=(t,e)=>t.indexOf(e)!==-1,kt=(t,...e)=>t.concat(e),Wt=(t,...e)=>t.filter(i=>!e.includes(i)),_e=(t,e)=>Nt(t,e)?Wt(t,e):kt(t,e);function Yt(t){for(;t.length>0;)t.pop();return t}var it=t=>(t==null?void 0:t.constructor.name)==="Array",zt=(t,e)=>{if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!gt(t[i],e[i]))return!1;return!0},gt=(t,e)=>{if(Object.is(t,e))return!0;if(t==null&&e!=null||t!=null&&e==null)return!1;if(typeof(t==null?void 0:t.isEqual)=="function"&&typeof(e==null?void 0:e.isEqual)=="function")return t.isEqual(e);if(typeof t=="function"&&typeof e=="function")return t.toString()===e.toString();if(it(t)&&it(e))return zt(Array.from(t),Array.from(e));if(typeof t!="object"||typeof e!="object")return!1;const i=Object.keys(e??Object.create(null)),o=i.length;for(let a=0;a<o;a++)if(!Reflect.has(t,i[a]))return!1;for(let a=0;a<o;a++){const c=i[a];if(!gt(t[c],e[c]))return!1}return!0},rt=(t,...e)=>(typeof t=="function"?t(...e):t)??void 0,P=t=>t,Ft=()=>{},Gt=(...t)=>(...e)=>{t.forEach(function(i){i==null||i(...e)})},ot=(()=>{let t=0;return()=>(t++,t.toString(36))})(),G=t=>Array.isArray(t),yt=t=>t!=null&&typeof t=="object",Y=t=>yt(t)&&!G(t),Kt=t=>typeof t=="number"&&!Number.isNaN(t),w=t=>typeof t=="string",K=t=>typeof t=="function",Te=t=>t==null,vt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),$t=t=>Object.prototype.toString.call(t),mt=Function.prototype.toString,It=mt.call(Object),Vt=t=>{if(!yt(t)||$t(t)!="[object Object]")return!1;const e=Object.getPrototypeOf(t);if(e===null)return!0;const i=vt(e,"constructor")&&e.constructor;return typeof i=="function"&&i instanceof i&&mt.call(i)==It};function qt(t,e){const i={},o={},a=new Set(e);for(const c in t)a.has(c)?o[c]=t[c]:i[c]=t[c];return[o,i]}var je=t=>function(i){return qt(i,t)};function $(t){if(!Bt(t)||t===void 0)return t;const e=Reflect.ownKeys(t).filter(o=>typeof o=="string"),i={};for(const o of e){const a=t[o];a!==void 0&&(i[o]=$(a))}return i}var Bt=t=>t&&typeof t=="object"&&t.constructor===Object;function q(...t){const e=t.length===1?t[0]:t[1],i=t.length===2?t[0]:!0}function z(...t){const e=t.length===1?t[0]:t[1],i=t.length===2?t[0]:!0}const Ht=Symbol(),Z=Symbol(),L="a",Et="f",at="p",St="c",wt="t",B="n",H="g",Ot="h",F="w",At="o",Pt="k";let Ut=(t,e)=>new Proxy(t,e);const J=Object.getPrototypeOf,Q=new WeakMap,bt=t=>t&&(Q.has(t)?Q.get(t):J(t)===Object.prototype||J(t)===Array.prototype),ct=t=>typeof t=="object"&&t!==null,Xt=t=>Object.values(Object.getOwnPropertyDescriptors(t)).some(e=>!e.configurable&&!e.writable),Jt=t=>{if(Array.isArray(t))return Array.from(t);const e=Object.getOwnPropertyDescriptors(t);return Object.values(e).forEach(i=>{i.configurable=!0}),Object.create(J(t),e)},Qt=(t,e)=>{const i={[Et]:e};let o=!1;const a=(s,r)=>{if(!o){let n=i[L].get(t);if(n||(n={},i[L].set(t,n)),s===F)n[F]=!0;else{let h=n[s];h||(h=new Set,n[s]=h),h.add(r)}}},c=()=>{o=!0,i[L].delete(t)},d={get(s,r){return r===Z?t:(a(Pt,r),Zt(Reflect.get(s,r),i[L],i[St],i[wt]))},has(s,r){return r===Ht?(c(),!0):(a(Ot,r),Reflect.has(s,r))},getOwnPropertyDescriptor(s,r){return a(At,r),Reflect.getOwnPropertyDescriptor(s,r)},ownKeys(s){return a(F),Reflect.ownKeys(s)}};return e&&(d.set=d.deleteProperty=()=>!1),[d,i]},Rt=t=>t[Z]||t,Zt=(t,e,i,o)=>{if(!bt(t))return t;let a=o&&o.get(t);if(!a){const r=Rt(t);Xt(r)?a=[r,Jt(r)]:a=[r],o==null||o.set(t,a)}const[c,d]=a;let s=i&&i.get(c);return(!s||s[1][Et]!==!!d)&&(s=Qt(c,!!d),s[1][at]=Ut(d||c,s[0]),i&&i.set(c,s)),s[1][L]=e,s[1][St]=i,s[1][wt]=o,s[1][at]},te=(t,e)=>{const i=Reflect.ownKeys(t),o=Reflect.ownKeys(e);return i.length!==o.length||i.some((a,c)=>a!==o[c])},ee=(t,e,i,o,a=Object.is)=>{if(a(t,e))return!1;if(!ct(t)||!ct(e))return!0;const c=i.get(Rt(t));if(!c)return!0;if(o){const s=o.get(t);if(s&&s[B]===e)return s[H];o.set(t,{[B]:e,[H]:!1})}let d=null;try{for(const s of c[Ot]||[])if(d=Reflect.has(t,s)!==Reflect.has(e,s),d)return d;if(c[F]===!0){if(d=te(t,e),d)return d}else for(const s of c[At]||[]){const r=!!Reflect.getOwnPropertyDescriptor(t,s),n=!!Reflect.getOwnPropertyDescriptor(e,s);if(d=r!==n,d)return d}for(const s of c[Pt]||[])if(d=ee(t[s],e[s],i,o,a),d)return d;return d===null&&(d=!0),d}finally{o&&o.set(t,{[B]:e,[H]:d})}},se=t=>bt(t)&&t[Z]||null,ht=(t,e=!0)=>{Q.set(t,e)};function ne(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function _t(t,e){const i=ne();return i?(i[t]||(i[t]=e()),i[t]):e()}var U=t=>typeof t=="object"&&t!==null,T=_t("__zag__proxyStateMap",()=>new WeakMap),N=_t("__zag__refSet",()=>new WeakSet),ie=t=>typeof t=="object"&&t!==null&&"$$typeof"in t,re=t=>typeof t=="object"&&t!==null&&"__v_isVNode"in t,oe=t=>typeof t=="object"&&t!==null&&"nodeType"in t&&typeof t.nodeName=="string",ae=t=>ie(t)||re(t)||oe(t),ce=(t=Object.is,e=(n,h)=>new Proxy(n,h),i=n=>U(n)&&!N.has(n)&&(Array.isArray(n)||!(Symbol.iterator in n))&&!ae(n)&&!(n instanceof WeakMap)&&!(n instanceof WeakSet)&&!(n instanceof Error)&&!(n instanceof Number)&&!(n instanceof Date)&&!(n instanceof String)&&!(n instanceof RegExp)&&!(n instanceof ArrayBuffer),o=n=>{switch(n.status){case"fulfilled":return n.value;case"rejected":throw n.reason;default:throw n}},a=new WeakMap,c=(n,h,u=o)=>{const l=a.get(n);if((l==null?void 0:l[0])===h)return l[1];const p=Array.isArray(n)?[]:Object.create(Object.getPrototypeOf(n));return ht(p,!0),a.set(n,[h,p]),Reflect.ownKeys(n).forEach(m=>{const E=Reflect.get(n,m);N.has(E)?(ht(E,!1),p[m]=E):E instanceof Promise?Object.defineProperty(p,m,{get(){return u(E)}}):T.has(E)?p[m]=M(E,u):p[m]=E}),Object.freeze(p)},d=new WeakMap,s=[1,1],r=n=>{if(!U(n))throw new Error("object required");const h=d.get(n);if(h)return h;let u=s[0];const l=new Set,p=(v,g=++s[0])=>{u!==g&&(u=g,l.forEach(y=>y(v,g)))};let m=s[1];const E=(v=++s[1])=>(m!==v&&!l.size&&(m=v,A.forEach(([g])=>{const y=g[1](v);y>u&&(u=y)})),u),_=v=>(g,y)=>{const S=[...g];S[1]=[v,...S[1]],p(S,y)},A=new Map,et=(v,g)=>{if(l.size){const y=g[3](_(v));A.set(v,[g,y])}else A.set(v,[g])},st=v=>{var y;const g=A.get(v);g&&(A.delete(v),(y=g[1])==null||y.call(g))},xt=v=>(l.add(v),l.size===1&&A.forEach(([y,S],j)=>{const C=y[3](_(j));A.set(j,[y,C])}),()=>{l.delete(v),l.size===0&&A.forEach(([y,S],j)=>{S&&(S(),A.set(j,[y]))})}),V=Array.isArray(n)?[]:Object.create(Object.getPrototypeOf(n)),k=e(V,{deleteProperty(v,g){const y=Reflect.get(v,g);st(g);const S=Reflect.deleteProperty(v,g);return S&&p(["delete",[g],y]),S},set(v,g,y,S){var nt;const j=Reflect.has(v,g),C=Reflect.get(v,g,S);if(j&&(t(C,y)||d.has(y)&&t(C,d.get(y))))return!0;st(g),U(y)&&(y=se(y)||y);let W=y;if(!((nt=Object.getOwnPropertyDescriptor(v,g))!=null&&nt.set))if(y instanceof Promise)y.then(b=>{Object.assign(y,{status:"fulfilled",value:b}),p(["resolve",[g],b])}).catch(b=>{Object.assign(y,{status:"rejected",reason:b}),p(["reject",[g],b])});else{!T.has(y)&&i(y)&&(W=tt(y));const b=!N.has(W)&&T.get(W);b&&et(g,b)}return Reflect.set(v,g,W,S),p(["set",[g],y,C]),!0}});d.set(n,k);const Lt=[V,E,c,xt];return T.set(k,Lt),Reflect.ownKeys(n).forEach(v=>{const g=Object.getOwnPropertyDescriptor(n,v);g.get||g.set?Object.defineProperty(V,v,g):k[v]=n[v]}),k})=>[r,T,N,t,e,i,o,a,c,d,s],[he]=ce();function tt(t={}){return he(t)}function ft(t,e,i){const o=T.get(t);let a;const c=[],d=o[3];let s=!1;const n=d(h=>{if(c.push(h),i){e(c.splice(0));return}a||(a=Promise.resolve().then(()=>{a=void 0,s&&e(c.splice(0))}))});return s=!0,()=>{s=!1,n()}}function M(t,e){const i=T.get(t),[o,a,c]=i;return c(o,a(),e)}function ut(t){return N.add(t),t}function fe(t,e){Object.keys(e).forEach(a=>{if(Object.getOwnPropertyDescriptor(t,a))throw new Error("object property already defined");const c=e[a],{get:d,set:s}=typeof c=="function"?{get:c}:c,r={};r.get=()=>d(M(o)),s&&(r.set=n=>s(o,n)),Object.defineProperty(t,a,r)});const o=tt(t);return o}function lt(t,e,i){typeof i.value=="object"&&(i.value=D(i.value)),!i.enumerable||i.get||i.set||!i.configurable||!i.writable||e==="__proto__"?Object.defineProperty(t,e,i):t[e]=i.value}function D(t){if(typeof t!="object")return t;var e=0,i,o,a,c=Object.prototype.toString.call(t);if(c==="[object Object]"?a=Object.create(t.__proto__||null):c==="[object Array]"?a=Array(t.length):c==="[object Set]"?(a=new Set,t.forEach(function(d){a.add(D(d))})):c==="[object Map]"?(a=new Map,t.forEach(function(d,s){a.set(D(s),D(d))})):c==="[object Date]"?a=new Date(+t):c==="[object RegExp]"?a=new RegExp(t.source,t.flags):c==="[object DataView]"?a=new t.constructor(D(t.buffer)):c==="[object ArrayBuffer]"?a=t.slice(0):c.slice(-6)==="Array]"&&(a=new t.constructor(t)),a){for(o=Object.getOwnPropertySymbols(t);e<o.length;e++)lt(a,o[e],Object.getOwnPropertyDescriptor(t,o[e]));for(e=0,o=Object.getOwnPropertyNames(t);e<o.length;e++)Object.hasOwnProperty.call(a,i=o[e])&&a[i]===t[i]||lt(a,i,Object.getOwnPropertyDescriptor(t,i))}return a||t}var ue=Object.defineProperty,le=(t,e,i)=>e in t?ue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,f=(t,e,i)=>le(t,typeof e!="symbol"?e+"":e,i);function Tt(t,...e){for(const i of e){const o=$(i);for(const a in o)Vt(i[a])?(t[a]||(t[a]={}),Tt(t[a],i[a])):t[a]=i[a]}return t}function dt(t){return D(t)}function O(t){return w(t)?{type:t}:t}function R(t){return t?G(t)?t.slice():[t]:[]}function jt(t){return Y(t)&&t.predicate!=null}var Mt=()=>!0;function I(t,e,i,o){return a=>{var c;return w(a)?!!((c=t[a])!=null&&c.call(t,e,i,o)):K(a)?a(e,i,o):a.predicate(t)(e,i,o)}}function de(...t){return{predicate:e=>(i,o,a)=>t.map(I(e,i,o,a)).some(Boolean)}}function pe(...t){return{predicate:e=>(i,o,a)=>t.map(I(e,i,o,a)).every(Boolean)}}function ge(t){return{predicate:e=>(i,o,a)=>!I(e,i,o,a)(t)}}function ye(...t){return(e,i,o)=>o.state.matches(...t)}var Me={or:de,and:pe,not:ge,stateIn:ye};function De(t){return{predicate:e=>(i,o,a)=>{var c;return(c=t.find(d=>{const s=d.guard??Mt;return I(e,i,o,a)(s)}))==null?void 0:c.actions}}}function Dt(t,e){return t=t??Mt,(i,o,a)=>{if(w(t)){const c=e[t];return K(c)?c(i,o,a):c}return jt(t)?t.predicate(e)(i,o,a):t==null?void 0:t(i,o,a)}}function X(t,e){return(i,o,a)=>jt(t)?t.predicate(e)(i,o,a):t}function ve(t){var c,d;const e=t.computed??P({}),i=t.context??P({}),o=t.initial?(d=(c=t.states)==null?void 0:c[t.initial])==null?void 0:d.tags:[],a=tt({value:t.initial??"",previousValue:"",event:P({}),previousEvent:P({}),context:fe(i,e),done:!1,tags:o??[],hasTag(s){return this.tags.includes(s)},matches(...s){return s.includes(this.value)},can(s){return P(this).nextEvents.includes(s)},get nextEvents(){var n,h;const s=((h=(n=t.states)==null?void 0:n[this.value])==null?void 0:h.on)??{},r=(t==null?void 0:t.on)??{};return Object.keys({...s,...r})},get changed(){return this.event.value==="machine.init"||!this.previousValue?!1:this.value!==this.previousValue}});return P(a)}function x(t,e){return(i,o)=>{if(Kt(t))return t;if(K(t))return t(i,o);if(w(t)){const a=Number.parseFloat(t);if(!Number.isNaN(a))return a;if(e){const c=e==null?void 0:e[t];return z(c==null,`[@zag-js/core > determine-delay] Cannot determine delay for \`${t}\`. It doesn't exist in \`options.delays\``),K(c)?c(i,o):c}}}}function me(t){return w(t)?{target:t}:t}function Ee(t,e){return(i,o,a)=>R(t).map(me).find(c=>Dt(c.guard,e)(i,o,a)??c.target??c.actions)}var Ct=class{constructor(t,e){var i,o,a,c,d;f(this,"status","Not Started"),f(this,"state"),f(this,"initialState"),f(this,"initialContext"),f(this,"id"),f(this,"type","machine"),f(this,"activityEvents",new Map),f(this,"delayedEvents",new Map),f(this,"stateListeners",new Set),f(this,"doneListeners",new Set),f(this,"contextWatchers",new Set),f(this,"removeStateListener",Ft),f(this,"parent"),f(this,"children",new Map),f(this,"guardMap"),f(this,"actionMap"),f(this,"delayMap"),f(this,"activityMap"),f(this,"sync"),f(this,"options"),f(this,"config"),f(this,"_created",()=>{var r;const s=O("machine.created");this.executeActions((r=this.config)==null?void 0:r.created,s)}),f(this,"start",s=>{if(this.state.value="",this.state.tags=[],this.status==="Running")return this;this.status="Running",this.removeStateListener=ft(this.state,()=>{this.stateListeners.forEach(p=>{p(this.stateSnapshot)})},this.sync),this.setupContextWatchers(),this.executeActivities(O("machine.start"),R(this.config.activities),"machine.start"),this.executeActions(this.config.entry,O("machine.start"));const r=O("machine.init"),n=Y(s)?s.value:s,h=Y(s)?s.context:void 0;h&&this.setContext(h);const u={target:n??this.config.initial},l=this.getNextStateInfo(u,r);return this.initialState=l,this.performStateChangeEffects(this.state.value,l,r),this}),f(this,"setupContextWatchers",()=>{const{watch:s}=this.config;if(!s)return;let r=M(this.state.context);const n=ft(this.state.context,()=>{var u;const h=M(this.state.context);for(const[l,p]of Object.entries(s))(((u=this.options.compareFns)==null?void 0:u[l])??Object.is)(r[l],h[l])||this.executeActions(p,this.state.event);r=h});this.contextWatchers.add(n)}),f(this,"stop",()=>{if(this.status!=="Stopped")return this.performExitEffects(this.state.value,O("machine.stop")),this.executeActions(this.config.exit,O("machine.stop")),this.setState(""),this.setEvent("machine.stop"),this.stopStateListeners(),this.stopChildren(),this.stopActivities(),this.stopDelayedEvents(),this.stopContextWatchers(),this.status="Stopped",this}),f(this,"stopStateListeners",()=>{this.removeStateListener(),this.stateListeners.clear()}),f(this,"stopContextWatchers",()=>{this.contextWatchers.forEach(s=>s()),this.contextWatchers.clear()}),f(this,"stopDelayedEvents",()=>{this.delayedEvents.forEach(s=>{s.forEach(r=>r())}),this.delayedEvents.clear()}),f(this,"stopActivities",s=>{var r,n;s?((r=this.activityEvents.get(s))==null||r.forEach(h=>h()),(n=this.activityEvents.get(s))==null||n.clear(),this.activityEvents.delete(s)):(this.activityEvents.forEach(h=>{h.forEach(u=>u()),h.clear()}),this.activityEvents.clear())}),f(this,"sendChild",(s,r)=>{const n=O(s),h=rt(r,this.contextSnapshot),u=this.children.get(h);u||z(`[@zag-js/core] Cannot send '${n.type}' event to unknown child`),u.send(n)}),f(this,"stopChild",s=>{this.children.has(s)||z(`[@zag-js/core > stop-child] Cannot stop unknown child ${s}`),this.children.get(s).stop(),this.children.delete(s)}),f(this,"removeChild",s=>{this.children.delete(s)}),f(this,"stopChildren",()=>{this.children.forEach(s=>s.stop()),this.children.clear()}),f(this,"setParent",s=>{this.parent=s}),f(this,"spawn",(s,r)=>{const n=rt(s);return r&&(n.id=r),n.type="machine.actor",n.setParent(this),this.children.set(n.id,P(n)),n.onDone(()=>{this.removeChild(n.id)}).start(),P(ut(n))}),f(this,"stopActivity",s=>{var n;if(!this.state.value)return;const r=this.activityEvents.get(this.state.value);(n=r==null?void 0:r.get(s))==null||n(),r==null||r.delete(s)}),f(this,"addActivityCleanup",(s,r,n)=>{var h;s&&(this.activityEvents.has(s)?(h=this.activityEvents.get(s))==null||h.set(r,n):this.activityEvents.set(s,new Map([[r,n]])))}),f(this,"setState",s=>{this.state.previousValue=this.state.value,this.state.value=s;const r=this.getStateNode(s);s==null?Yt(this.state.tags):this.state.tags=R(r==null?void 0:r.tags)}),f(this,"setContext",s=>{s&&Tt(this.state.context,$(s))}),f(this,"setOptions",s=>{const r=$(s);this.actionMap={...this.actionMap,...r.actions},this.delayMap={...this.delayMap,...r.delays},this.activityMap={...this.activityMap,...r.activities},this.guardMap={...this.guardMap,...r.guards}}),f(this,"getStateNode",s=>{var r;if(s)return(r=this.config.states)==null?void 0:r[s]}),f(this,"getNextStateInfo",(s,r)=>{const n=this.determineTransition(s,r),h=!(n!=null&&n.target),u=(n==null?void 0:n.target)??this.state.value,l=this.state.value!==u,p=this.getStateNode(u),E={reenter:!h&&!l&&!(n!=null&&n.internal),transition:n,stateNode:p,target:u,changed:l};return this.log("NextState:",`[${r.type}]`,this.state.value,"---->",E.target),E}),f(this,"getAfterActions",(s,r)=>{let n;const h=this.state.value;return{entry:()=>{n=globalThis.setTimeout(()=>{const u=this.getNextStateInfo(s,this.state.event);this.performStateChangeEffects(h,u,this.state.event)},r)},exit:()=>{globalThis.clearTimeout(n)}}}),f(this,"getDelayedEventActions",s=>{const r=this.getStateNode(s),n=this.state.event;if(!r||!r.after)return;const h=[],u=[];if(G(r.after)){const l=this.determineTransition(r.after,n);if(!l)return;if(!vt(l,"delay"))throw new Error(`[@zag-js/core > after] Delay is required for after transition: ${JSON.stringify(l)}`);const m=x(l.delay,this.delayMap)(this.contextSnapshot,n),E=this.getAfterActions(l,m);return h.push(E.entry),u.push(E.exit),{entries:h,exits:u}}if(Y(r.after))for(const l in r.after){const p=r.after[l],E=x(l,this.delayMap)(this.contextSnapshot,n),_=this.getAfterActions(p,E);h.push(_.entry),u.push(_.exit)}return{entries:h,exits:u}}),f(this,"executeActions",(s,r)=>{var h;const n=X(s,this.guardMap)(this.contextSnapshot,r,this.guardMeta);for(const u of R(n)){const l=w(u)?(h=this.actionMap)==null?void 0:h[u]:u;q(w(u)&&!l,`[@zag-js/core > execute-actions] No implementation found for action: \`${u}\``),l==null||l(this.state.context,r,this.meta)}}),f(this,"executeActivities",(s,r,n)=>{var h;for(const u of r){const l=w(u)?(h=this.activityMap)==null?void 0:h[u]:u;if(!l){q(`[@zag-js/core > execute-activity] No implementation found for activity: \`${u}\``);continue}const p=l(this.state.context,s,this.meta);if(p){const m=w(u)?u:u.name||ot();this.addActivityCleanup(n??this.state.value,m,p)}}}),f(this,"createEveryActivities",(s,r)=>{if(s)if(G(s)){const n=R(s).find(p=>{const m=p.delay,_=x(m,this.delayMap)(this.contextSnapshot,this.state.event);return Dt(p.guard,this.guardMap)(this.contextSnapshot,this.state.event,this.guardMeta)??_!=null});if(!n)return;const u=x(n.delay,this.delayMap)(this.contextSnapshot,this.state.event);r(()=>{const p=globalThis.setInterval(()=>{this.executeActions(n.actions,this.state.event)},u);return()=>{globalThis.clearInterval(p)}})}else for(const n in s){const h=s==null?void 0:s[n],l=x(n,this.delayMap)(this.contextSnapshot,this.state.event);r(()=>{const m=globalThis.setInterval(()=>{this.executeActions(h,this.state.event)},l);return()=>{globalThis.clearInterval(m)}})}}),f(this,"setEvent",s=>{this.state.previousEvent=this.state.event,this.state.event=ut(O(s))}),f(this,"performExitEffects",(s,r)=>{const n=this.state.value;if(n==="")return;const h=s?this.getStateNode(s):void 0;this.stopActivities(n);const u=X(h==null?void 0:h.exit,this.guardMap)(this.contextSnapshot,r,this.guardMeta),l=R(u),p=this.delayedEvents.get(n);p&&l.push(...p),this.executeActions(l,r),this.delayedEvents.delete(n)}),f(this,"performEntryEffects",(s,r)=>{const n=this.getStateNode(s),h=R(n==null?void 0:n.activities);this.createEveryActivities(n==null?void 0:n.every,m=>{h.unshift(m)}),h.length>0&&this.executeActivities(r,h);const u=X(n==null?void 0:n.entry,this.guardMap)(this.contextSnapshot,r,this.guardMeta),l=R(u),p=this.getDelayedEventActions(s);n!=null&&n.after&&p&&(this.delayedEvents.set(s,p==null?void 0:p.exits),l.push(...p.entries)),this.executeActions(l,r),(n==null?void 0:n.type)==="final"&&(this.state.done=!0,this.doneListeners.forEach(m=>{m(this.stateSnapshot)}),this.stop())}),f(this,"performTransitionEffects",(s,r)=>{const n=this.determineTransition(s,r);this.executeActions(n==null?void 0:n.actions,r)}),f(this,"performStateChangeEffects",(s,r,n)=>{this.setEvent(n);const h=r.changed||r.reenter;h&&this.performExitEffects(s,n),this.performTransitionEffects(r.transition,n),this.setState(r.target),h&&this.performEntryEffects(r.target,n)}),f(this,"determineTransition",(s,r)=>{const n=Ee(s,this.guardMap);return n==null?void 0:n(this.contextSnapshot,r,this.guardMeta)}),f(this,"sendParent",s=>{var n;this.parent||z("[@zag-js/core > send-parent] Cannot send event to an unknown parent");const r=O(s);(n=this.parent)==null||n.send(r)}),f(this,"log",(...s)=>{}),f(this,"send",s=>{const r=O(s);this.transition(this.state.value,r)}),f(this,"transition",(s,r)=>{var p,m;const n=w(s)?this.getStateNode(s):s==null?void 0:s.stateNode,h=O(r);if(!n&&!this.config.on){const E=this.status==="Stopped"?"[@zag-js/core > transition] Cannot transition a stopped machine":`[@zag-js/core > transition] State does not have a definition for \`state\`: ${s}, \`event\`: ${h.type}`;q(E);return}const u=((p=n==null?void 0:n.on)==null?void 0:p[h.type])??((m=this.config.on)==null?void 0:m[h.type]),l=this.getNextStateInfo(u,h);return this.performStateChangeEffects(this.state.value,l,h),l.stateNode}),f(this,"subscribe",s=>(this.stateListeners.add(s),this.status==="Running"&&s(this.stateSnapshot),()=>{this.stateListeners.delete(s)})),f(this,"onDone",s=>(this.doneListeners.add(s),this)),f(this,"onTransition",s=>(this.stateListeners.add(s),this.status==="Running"&&s(this.stateSnapshot),this)),this.config=dt(t),this.options=dt(e??{}),this.id=this.config.id??`machine-${ot()}`,this.guardMap=((i=this.options)==null?void 0:i.guards)??{},this.actionMap=((o=this.options)==null?void 0:o.actions)??{},this.delayMap=((a=this.options)==null?void 0:a.delays)??{},this.activityMap=((c=this.options)==null?void 0:c.activities)??{},this.sync=((d=this.options)==null?void 0:d.sync)??!1,this.state=ve(this.config),this.initialContext=M(this.state.context)}get stateSnapshot(){return P(M(this.state))}getState(){return this.stateSnapshot}get contextSnapshot(){return this.stateSnapshot.context}get self(){const t=this;return{id:this.id,send:this.send.bind(this),sendParent:this.sendParent.bind(this),sendChild:this.sendChild.bind(this),stop:this.stop.bind(this),stopChild:this.stopChild.bind(this),spawn:this.spawn.bind(this),stopActivity:this.stopActivity.bind(this),get state(){return t.stateSnapshot},get initialContext(){return t.initialContext},get initialState(){var e;return((e=t.initialState)==null?void 0:e.target)??""}}}get meta(){var t;return{state:this.stateSnapshot,guards:this.guardMap,send:this.send.bind(this),self:this.self,initialContext:this.initialContext,initialState:((t=this.initialState)==null?void 0:t.target)??"",getState:()=>this.stateSnapshot,getAction:e=>this.actionMap[e],getGuard:e=>this.guardMap[e]}}get guardMeta(){return{state:this.stateSnapshot}}get[Symbol.toStringTag](){return"Machine"}getHydrationState(){const t=this.getState();return{value:t.value,tags:t.tags}}},Ce=(t,e)=>new Ct(t,e),xe=t=>t instanceof Ct||(t==null?void 0:t.type)==="machine",Se=(...t)=>t.map(e=>{var i;return(i=e==null?void 0:e.trim)==null?void 0:i.call(e)}).filter(Boolean).join(" "),we=/((?:--)?(?:\w+-?)+)\s*:\s*([^;]*)/g,pt=t=>{const e={};let i;for(;i=we.exec(t);)e[i[1]]=i[2];return e},Oe=(t,e)=>{if(w(t)){if(w(e))return`${t};${e}`;t=pt(t)}else w(e)&&(e=pt(e));return Object.assign({},t??{},e??{})};function Le(...t){let e={};for(let i of t){for(let o in e){if(o.startsWith("on")&&typeof e[o]=="function"&&typeof i[o]=="function"){e[o]=Gt(i[o],e[o]);continue}if(o==="className"||o==="class"){e[o]=Se(e[o],i[o]);continue}if(o==="style"){e[o]=Oe(e[o],i[o]);continue}e[o]=i[o]!==void 0?i[o]:e[o]}for(let o in i)e[o]===void 0&&(e[o]=i[o])}return e}export{P as A,Y as B,vt as C,_e as D,xe as E,ot as F,Pe as G,tt as H,Ce as a,w as b,$ as c,K as d,Gt as e,Te as f,Me as g,z as h,gt as i,De as j,Kt as k,M as l,_t as m,Ft as n,ee as o,Zt as p,be as q,rt as r,ft as s,Re as t,je as u,Wt as v,q as w,kt as x,ut as y,Le as z};
