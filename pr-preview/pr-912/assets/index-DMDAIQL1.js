import{c as p}from"./index-BRNWFSEf.js";import{c as u,n as E,r as c}from"./index-51odREz2.js";import{p as O,a as C,c as m}from"./focus-trap.esm-D1qb2f5l.js";import{c as I,a as v}from"./index-DkshEfrg.js";import{t as f}from"./index-IUjCT-0R.js";import{c as k}from"./index-Ctx6eFvH.js";var T=p("dialog").parts("trigger","backdrop","positioner","content","title","description","closeTrigger"),a=T.build(),o=u({getPositionerId:t=>{var n;return((n=t.ids)==null?void 0:n.positioner)??`dialog:${t.id}:positioner`},getBackdropId:t=>{var n;return((n=t.ids)==null?void 0:n.backdrop)??`dialog:${t.id}:backdrop`},getContentId:t=>{var n;return((n=t.ids)==null?void 0:n.content)??`dialog:${t.id}:content`},getTriggerId:t=>{var n;return((n=t.ids)==null?void 0:n.trigger)??`dialog:${t.id}:trigger`},getTitleId:t=>{var n;return((n=t.ids)==null?void 0:n.title)??`dialog:${t.id}:title`},getDescriptionId:t=>{var n;return((n=t.ids)==null?void 0:n.description)??`dialog:${t.id}:description`},getCloseTriggerId:t=>{var n;return((n=t.ids)==null?void 0:n.closeTrigger)??`dialog:${t.id}:close`},getContentEl:t=>o.getById(t,o.getContentId(t)),getPositionerEl:t=>o.getById(t,o.getPositionerId(t)),getBackdropEl:t=>o.getById(t,o.getBackdropId(t)),getTriggerEl:t=>o.getById(t,o.getTriggerId(t)),getTitleEl:t=>o.getById(t,o.getTitleId(t)),getDescriptionEl:t=>o.getById(t,o.getDescriptionId(t)),getCloseTriggerEl:t=>o.getById(t,o.getCloseTriggerId(t))});function B(t,n,e){const r=t.context["aria-label"],s=t.matches("open"),d=t.context.renderedElements;return{open:s,setOpen(i){i!==s&&n(i?"OPEN":"CLOSE")},getTriggerProps(){return e.button({...a.trigger.attrs,dir:t.context.dir,id:o.getTriggerId(t.context),"aria-haspopup":"dialog",type:"button","aria-expanded":s,"data-state":s?"open":"closed","aria-controls":o.getContentId(t.context),onClick(i){i.defaultPrevented||n("TOGGLE")}})},getBackdropProps(){return e.element({...a.backdrop.attrs,dir:t.context.dir,hidden:!s,id:o.getBackdropId(t.context),"data-state":s?"open":"closed"})},getPositionerProps(){return e.element({...a.positioner.attrs,dir:t.context.dir,id:o.getPositionerId(t.context),style:{pointerEvents:s?void 0:"none"}})},getContentProps(){return e.element({...a.content.attrs,dir:t.context.dir,role:t.context.role,hidden:!s,id:o.getContentId(t.context),tabIndex:-1,"data-state":s?"open":"closed","aria-modal":!0,"aria-label":r||void 0,"aria-labelledby":r||!d.title?void 0:o.getTitleId(t.context),"aria-describedby":d.description?o.getDescriptionId(t.context):void 0})},getTitleProps(){return e.element({...a.title.attrs,dir:t.context.dir,id:o.getTitleId(t.context)})},getDescriptionProps(){return e.element({...a.description.attrs,dir:t.context.dir,id:o.getDescriptionId(t.context)})},getCloseTriggerProps(){return e.button({...a.closeTrigger.attrs,dir:t.context.dir,id:o.getCloseTriggerId(t.context),type:"button",onClick(i){i.defaultPrevented||(i.stopPropagation(),n("CLOSE"))}})}}}function h(t){const n=I(t);return v({id:"dialog",initial:n.open?"open":"closed",context:{role:"dialog",renderedElements:{title:!0,description:!0},modal:!0,trapFocus:!0,preventScroll:!0,closeOnInteractOutside:!0,closeOnEscape:!0,restoreFocus:!0,...n},created:["setAlertDialogProps"],watch:{open:["toggleVisibility"]},states:{open:{entry:["checkRenderedElements","syncZIndex"],activities:["trackDismissableElement","trapFocus","preventScroll","hideContentBelow"],on:{"CONTROLLED.CLOSE":{target:"closed"},CLOSE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose"]}],TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose"]}]}},closed:{on:{"CONTROLLED.OPEN":{target:"open"},OPEN:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen"]}],TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen"]}]}}}},{guards:{isOpenControlled:e=>!!e["open.controlled"]},activities:{trackDismissableElement(e,r,{send:s}){return f(()=>o.getContentEl(e),{defer:!0,pointerBlocking:e.modal,exclude:[o.getTriggerEl(e)],onInteractOutside(i){var l;(l=e.onInteractOutside)==null||l.call(e,i),e.closeOnInteractOutside||i.preventDefault()},persistentElements:e.persistentElements,onFocusOutside:e.onFocusOutside,onPointerDownOutside:e.onPointerDownOutside,onEscapeKeyDown(i){var l;(l=e.onEscapeKeyDown)==null||l.call(e,i),e.closeOnEscape||i.preventDefault()},onDismiss(){s({type:"CLOSE",src:"interact-outside"})}})},preventScroll(e){if(e.preventScroll)return O(o.getDoc(e))},trapFocus(e){if(!e.trapFocus||!e.modal)return;let r;const s=E(()=>{var i;const d=o.getContentEl(e);if(d){r=m(d,{document:o.getDoc(e),escapeDeactivates:!1,preventScroll:!0,fallbackFocus:d,returnFocusOnDeactivate:!!e.restoreFocus,allowOutsideClick:!0,initialFocus:((i=e.initialFocusEl)==null?void 0:i.call(e))??void 0,setReturnFocus(l){var g;return((g=e.finalFocusEl)==null?void 0:g.call(e))??l}});try{r.activate()}catch{}}});return()=>{r==null||r.deactivate(),s()}},hideContentBelow(e){return e.modal?C(()=>[o.getContentEl(e)],{defer:!0}):void 0}},actions:{setAlertDialogProps(e){e.role==="alertdialog"&&(e.initialFocusEl||(e.initialFocusEl=()=>o.getCloseTriggerEl(e)),e.closeOnInteractOutside=!1)},checkRenderedElements(e){c(()=>{e.renderedElements.title=!!o.getTitleEl(e),e.renderedElements.description=!!o.getDescriptionEl(e)})},syncZIndex(e){c(()=>{const r=o.getContentEl(e);if(!r)return;const d=o.getWin(e).getComputedStyle(r);[o.getPositionerEl(e),o.getBackdropEl(e)].forEach(l=>{l==null||l.style.setProperty("--z-index",d.zIndex)})})},invokeOnClose(e){var r;(r=e.onOpenChange)==null||r.call(e,{open:!1})},invokeOnOpen(e){var r;(r=e.onOpenChange)==null||r.call(e,{open:!0})},toggleVisibility(e,r,{send:s}){s({type:e.open?"CONTROLLED.OPEN":"CONTROLLED.CLOSE",previousEvent:r})}}})}k()(["aria-label","closeOnEscape","closeOnInteractOutside","dir","finalFocusEl","getRootNode","getRootNode","id","id","ids","initialFocusEl","modal","onEscapeKeyDown","onFocusOutside","onInteractOutside","onOpenChange","onPointerDownOutside","open.controlled","open","persistentElements","preventScroll","restoreFocus","role","trapFocus"]);export{T as a,B as c,h as m};
