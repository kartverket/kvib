import{j as m}from"./jsx-runtime-D_zvdyIk.js";import{h as j,m as T,a as y,j as pe}from"./factory-D1kTn8Vm.js";import{r as h}from"./index-Bj2TM2QZ.js";import{m as be}from"./factory-Dw0YElUz.js";import{c as Ee}from"./create-slot-recipe-context-D2d5s3G5.js";import{r as N,g as me,b as he,i as ye,e as F,f as B,h as U,j as K,k as Pe,l as _,m as z,n as W,c as we,o as v,p as D,q as Ce,s as Te,t as Ie}from"./index-juDyHp0C.js";import{c as Oe,a as G}from"./index-BqWtAW9h.js";import{c as Ve,u as Le,a as Se,n as ke}from"./index-C2TN6jS0.js";import{u as Re}from"./use-environment-context-C8zqKP5z.js";import{u as J}from"./use-field-context-Cx-xQZBF.js";function xe(e){const t={each(r){var n;for(let i=0;i<((n=e.frames)==null?void 0:n.length);i+=1){const a=e.frames[i];a&&r(a)}},addEventListener(r,n,i){return t.each(a=>{try{a.document.addEventListener(r,n,i)}catch{}}),()=>{try{t.removeEventListener(r,n,i)}catch{}}},removeEventListener(r,n,i){t.each(a=>{try{a.document.removeEventListener(r,n,i)}catch{}})}};return t}function Ae(e){const t=e.frameElement!=null?e.parent:null;return{addEventListener:(r,n,i)=>{try{t==null||t.addEventListener(r,n,i)}catch{}return()=>{try{t==null||t.removeEventListener(r,n,i)}catch{}}},removeEventListener:(r,n,i)=>{try{t==null||t.removeEventListener(r,n,i)}catch{}}}}var q="pointerdown.outside",Y="focus.outside";function Ne(e){for(const t of e)if(_(t)&&K(t))return!0;return!1}var Q=e=>"clientY"in e;function De(e,t){if(!Q(t)||!e)return!1;const r=e.getBoundingClientRect();return r.width===0||r.height===0?!1:r.top<=t.clientY&&t.clientY<=r.top+r.height&&r.left<=t.clientX&&t.clientX<=r.left+r.width}function Me(e,t){return e.y<=t.y&&t.y<=e.y+e.height&&e.x<=t.x&&t.x<=e.x+e.width}function X(e,t){if(!t||!Q(e))return!1;const r=t.scrollHeight>t.clientHeight,n=r&&e.clientX>t.offsetLeft+t.clientWidth,i=t.scrollWidth>t.clientWidth,a=i&&e.clientY>t.offsetTop+t.clientHeight,s={x:t.offsetLeft,y:t.offsetTop,width:t.clientWidth+(r?16:0),height:t.clientHeight+(i?16:0)},P={x:e.clientX,y:e.clientY};return Me(s,P)?n||a:!1}function Fe(e,t){const{exclude:r,onFocusOutside:n,onPointerDownOutside:i,onInteractOutside:a,defer:s}=t;if(!e)return;const P=me(e),b=he(e),f=xe(b),k=Ae(b);function O(d,p){if(!_(p)||!p.isConnected||z(e,p)||De(e,d))return!1;const o=P.querySelector(`[aria-controls="${e.id}"]`);if(o){const c=W(o);if(X(d,c))return!1}const R=W(e);return X(d,R)?!1:!(r!=null&&r(p))}const g=new Set,u=ye(e==null?void 0:e.getRootNode());function l(d){function p(o){var x;const R=s&&!B()?N:A=>A(),c=o??d,w=((x=c==null?void 0:c.composedPath)==null?void 0:x.call(c))??[c==null?void 0:c.target];R(()=>{const A=u?w[0]:U(d);if(!(!e||!O(d,A))){if(i||a){const ve=j(i,a);e.addEventListener(q,ve,{once:!0})}H(e,q,{bubbles:!1,cancelable:!0,detail:{originalEvent:c,contextmenu:Pe(c),focusable:Ne(w),target:A}})}})}d.pointerType==="touch"?(g.forEach(o=>o()),g.add(F(P,"click",p,{once:!0})),g.add(k.addEventListener("click",p,{once:!0})),g.add(f.addEventListener("click",p,{once:!0}))):p()}const E=new Set,V=setTimeout(()=>{E.add(F(P,"pointerdown",l,!0)),E.add(k.addEventListener("pointerdown",l,!0)),E.add(f.addEventListener("pointerdown",l,!0))},0);function L(d){(s?N:o=>o())(()=>{const o=U(d);if(!(!e||!O(d,o))){if(n||a){const R=j(n,a);e.addEventListener(Y,R,{once:!0})}H(e,Y,{bubbles:!1,cancelable:!0,detail:{originalEvent:d,contextmenu:!1,focusable:K(o),target:o}})}})}return B()||(E.add(F(P,"focusin",L,!0)),E.add(k.addEventListener("focusin",L,!0)),E.add(f.addEventListener("focusin",L,!0))),()=>{clearTimeout(V),g.forEach(d=>d()),E.forEach(d=>d())}}function $e(e,t){const{defer:r}=t,n=r?N:a=>a(),i=[];return i.push(n(()=>{const a=typeof e=="function"?e():e;i.push(Fe(a,t))})),()=>{i.forEach(a=>a==null?void 0:a())}}function H(e,t,r){const n=e.ownerDocument.defaultView||window,i=new n.CustomEvent(t,r);return e.dispatchEvent(i)}const[Z,I]=we({name:"EditableContext",hookName:"useEditableContext",providerName:"<EditableProvider />"}),ee=h.forwardRef((e,t)=>{const r=I(),n=T(r.getAreaProps(),e);return m.jsx(y.div,{...n,ref:t})});ee.displayName="EditableArea";const te=h.forwardRef((e,t)=>{const r=I(),n=T(r.getCancelTriggerProps(),e);return m.jsx(y.button,{...n,ref:t})});te.displayName="EditableCancelTrigger";const je=e=>e.children(I()),re=h.forwardRef((e,t)=>{const r=I(),n=T(r.getControlProps(),e);return m.jsx(y.div,{...n,ref:t})});re.displayName="EditableControl";const ie=h.forwardRef((e,t)=>{const r=I(),n=T(r.getEditTriggerProps(),e);return m.jsx(y.button,{...n,ref:t})});ie.displayName="EditableEditTrigger";const ne=h.forwardRef((e,t)=>{const r=I(),n=T(r.getInputProps(),e),i=J();return m.jsx(y.input,{"aria-describedby":i==null?void 0:i.ariaDescribedby,...n,ref:t})});ne.displayName="EditableInput";const ae=h.forwardRef((e,t)=>{const r=I(),n=T(r.getPreviewProps(),e);return m.jsx(y.span,{...n,ref:t})});ae.displayName="EditablePreview";var Be=Oe("editable").parts("root","area","label","preview","input","editTrigger","submitTrigger","cancelTrigger","control"),C=Be.build(),Ue=e=>{var t;return((t=e.ids)==null?void 0:t.root)??`editable:${e.id}`},We=e=>{var t;return((t=e.ids)==null?void 0:t.area)??`editable:${e.id}:area`},qe=e=>{var t;return((t=e.ids)==null?void 0:t.label)??`editable:${e.id}:label`},oe=e=>{var t;return((t=e.ids)==null?void 0:t.preview)??`editable:${e.id}:preview`},$=e=>{var t;return((t=e.ids)==null?void 0:t.input)??`editable:${e.id}:input`},Ye=e=>{var t;return((t=e.ids)==null?void 0:t.control)??`editable:${e.id}:control`},se=e=>{var t;return((t=e.ids)==null?void 0:t.submitTrigger)??`editable:${e.id}:submit`},de=e=>{var t;return((t=e.ids)==null?void 0:t.cancelTrigger)??`editable:${e.id}:cancel`},ue=e=>{var t;return((t=e.ids)==null?void 0:t.editTrigger)??`editable:${e.id}:edit`},M=e=>e.getById($(e)),Xe=e=>e.getById(oe(e)),He=e=>e.getById(se(e)),Ke=e=>e.getById(de(e)),_e=e=>e.getById(ue(e));function ze(e,t){const{state:r,context:n,send:i,prop:a,scope:s,computed:P}=e,b=a("disabled"),f=P("isInteractive"),k=a("readOnly"),O=a("invalid"),g=a("autoResize"),u=a("translations"),l=r.matches("edit"),E=a("placeholder"),V=typeof E=="string"?{edit:E,preview:E}:E,L=n.get("value"),d=L.trim()==="",p=d?(V==null?void 0:V.preview)??"":L;return{editing:l,empty:d,value:L,valueText:p,setValue(o){i({type:"VALUE.SET",value:o,src:"setValue"})},clearValue(){i({type:"VALUE.SET",value:"",src:"clearValue"})},edit(){f&&i({type:"EDIT"})},cancel(){f&&i({type:"CANCEL"})},submit(){f&&i({type:"SUBMIT"})},getRootProps(){return t.element({...C.root.attrs,id:Ue(s),dir:a("dir")})},getAreaProps(){return t.element({...C.area.attrs,id:We(s),dir:a("dir"),style:g?{display:"inline-grid"}:void 0,"data-focus":v(l),"data-disabled":v(b),"data-placeholder-shown":v(d)})},getLabelProps(){return t.label({...C.label.attrs,id:qe(s),dir:a("dir"),htmlFor:$(s),"data-focus":v(l),"data-invalid":v(O),onClick(){if(l)return;const o=Xe(s);o==null||o.focus({preventScroll:!0})}})},getInputProps(){return t.input({...C.input.attrs,dir:a("dir"),"aria-label":u==null?void 0:u.input,name:a("name"),form:a("form"),id:$(s),hidden:g?void 0:!l,placeholder:V==null?void 0:V.edit,maxLength:a("maxLength"),required:a("required"),disabled:b,"data-disabled":v(b),readOnly:k,"data-readonly":v(k),"aria-invalid":D(O),"data-invalid":v(O),"data-autoresize":v(g),defaultValue:L,size:g?1:void 0,onChange(o){i({type:"VALUE.SET",src:"input.change",value:o.currentTarget.value})},onKeyDown(o){if(o.defaultPrevented||Ce(o))return;const c={Escape(){i({type:"CANCEL"}),o.preventDefault()},Enter(w){if(!P("submitOnEnter"))return;const{localName:x}=w.currentTarget;if(x==="textarea"){if(!(Te()?w.metaKey:w.ctrlKey))return;i({type:"SUBMIT",src:"keydown.enter"});return}x==="input"&&!w.shiftKey&&!w.metaKey&&(i({type:"SUBMIT",src:"keydown.enter"}),w.preventDefault())}}[o.key];c&&c(o)},style:g?{gridArea:"1 / 1 / auto / auto",visibility:l?void 0:"hidden"}:void 0})},getPreviewProps(){return t.element({id:oe(s),...C.preview.attrs,dir:a("dir"),"data-placeholder-shown":v(d),"aria-readonly":D(k),"data-readonly":v(b),"data-disabled":v(b),"aria-disabled":D(b),"aria-invalid":D(O),"data-invalid":v(O),"aria-label":u==null?void 0:u.edit,"data-autoresize":v(g),children:p,hidden:g?void 0:l,tabIndex:f?0:void 0,onClick(){f&&a("activationMode")==="click"&&i({type:"EDIT",src:"click"})},onFocus(){f&&a("activationMode")==="focus"&&i({type:"EDIT",src:"focus"})},onDoubleClick(o){o.defaultPrevented||f&&a("activationMode")==="dblclick"&&i({type:"EDIT",src:"dblclick"})},style:g?{whiteSpace:"pre",userSelect:"none",gridArea:"1 / 1 / auto / auto",visibility:l?"hidden":void 0,overflow:"hidden",textOverflow:"ellipsis"}:void 0})},getEditTriggerProps(){return t.button({...C.editTrigger.attrs,id:ue(s),dir:a("dir"),"aria-label":u==null?void 0:u.edit,hidden:l,type:"button",disabled:b,onClick(o){o.defaultPrevented||f&&i({type:"EDIT",src:"edit.click"})}})},getControlProps(){return t.element({id:Ye(s),...C.control.attrs,dir:a("dir")})},getSubmitTriggerProps(){return t.button({...C.submitTrigger.attrs,dir:a("dir"),id:se(s),"aria-label":u==null?void 0:u.submit,hidden:!l,disabled:b,type:"button",onClick(o){o.defaultPrevented||f&&i({type:"SUBMIT",src:"submit.click"})}})},getCancelTriggerProps(){return t.button({...C.cancelTrigger.attrs,dir:a("dir"),"aria-label":u==null?void 0:u.cancel,id:de(s),hidden:!l,type:"button",disabled:b,onClick(o){o.defaultPrevented||f&&i({type:"CANCEL",src:"cancel.click"})}})}}}var Ge=pe({props({props:e}){return{activationMode:"focus",submitMode:"both",defaultValue:"",selectOnFocus:!0,...e,translations:{input:"editable input",edit:"edit",submit:"submit",cancel:"cancel",...e.translations}}},initialState({prop:e}){return e("edit")||e("defaultEdit")?"edit":"preview"},entry:["focusInputIfNeeded"],context:({bindable:e,prop:t})=>({value:e(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange(r){var n;return(n=t("onValueChange"))==null?void 0:n({value:r})}})),previousValue:e(()=>({defaultValue:""}))}),watch({track:e,action:t,context:r,prop:n}){e([()=>r.get("value")],()=>{t(["syncInputValue"])}),e([()=>n("edit")],()=>{t(["toggleEditing"])})},computed:{submitOnEnter({prop:e}){return["both","enter"].includes(e("submitMode"))},submitOnBlur({prop:e}){return["both","blur"].includes(e("submitMode"))},isInteractive({prop:e}){return!(e("disabled")||e("readOnly"))}},on:{"VALUE.SET":{actions:["setValue"]}},states:{preview:{entry:["blurInputIfNeeded"],on:{"CONTROLLED.EDIT":{target:"edit",actions:["setPreviousValue","focusInput"]},EDIT:[{guard:"isEditControlled",actions:["invokeOnEdit"]},{target:"edit",actions:["setPreviousValue","focusInput","invokeOnEdit"]}]}},edit:{effects:["trackInteractOutside"],on:{"CONTROLLED.PREVIEW":[{guard:"isSubmitEvent",target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel"]}],CANCEL:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel","invokeOnPreview"]}],SUBMIT:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit","invokeOnPreview"]}]}}},implementations:{guards:{isEditControlled:({prop:e})=>e("edit")!=null,isSubmitEvent:({event:e})=>{var t;return((t=e.previousEvent)==null?void 0:t.type)==="SUBMIT"}},effects:{trackInteractOutside({send:e,scope:t,prop:r,computed:n}){return $e(M(t),{exclude(i){return[Ke(t),He(t)].some(s=>z(s,i))},onFocusOutside:r("onFocusOutside"),onPointerDownOutside:r("onPointerDownOutside"),onInteractOutside(i){var s;if((s=r("onInteractOutside"))==null||s(i),i.defaultPrevented)return;const{focusable:a}=i.detail;e({type:n("submitOnBlur")?"SUBMIT":"CANCEL",src:"interact-outside",focusable:a})}})}},actions:{restoreFocus({event:e,scope:t,prop:r}){e.focusable||N(()=>{var i;const n=((i=r("finalFocusEl"))==null?void 0:i())??_e(t);n==null||n.focus({preventScroll:!0})})},clearValue({context:e}){e.set("value","")},focusInputIfNeeded({action:e,prop:t}){(t("edit")||t("defaultEdit"))&&e(["focusInput"])},focusInput({scope:e,prop:t}){N(()=>{const r=M(e);r&&(t("selectOnFocus")?r.select():r.focus({preventScroll:!0}))})},invokeOnCancel({prop:e,context:t}){var n;const r=t.get("previousValue");(n=e("onValueRevert"))==null||n({value:r})},invokeOnSubmit({prop:e,context:t}){var n;const r=t.get("value");(n=e("onValueCommit"))==null||n({value:r})},invokeOnEdit({prop:e}){var t;(t=e("onEditChange"))==null||t({edit:!0})},invokeOnPreview({prop:e}){var t;(t=e("onEditChange"))==null||t({edit:!1})},toggleEditing({prop:e,send:t,event:r}){t({type:e("edit")?"CONTROLLED.EDIT":"CONTROLLED.PREVIEW",previousEvent:r})},syncInputValue({context:e,scope:t}){const r=M(t);r&&Ie(r,e.get("value"))},setValue({context:e,prop:t,event:r}){const n=t("maxLength"),i=n!=null?r.value.slice(0,n):r.value;e.set("value",i)},setPreviousValue({context:e}){e.set("previousValue",e.get("value"))},revertValue({context:e}){const t=e.get("previousValue");t&&e.set("value",t)},blurInputIfNeeded({scope:e}){var t;(t=M(e))==null||t.blur()}}}});Ve()(["activationMode","autoResize","dir","disabled","finalFocusEl","form","getRootNode","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","edit","defaultEdit","submitMode","translations","defaultValue","value"]);const Je=e=>{const t=h.useId(),{getRootNode:r}=Re(),{dir:n}=Le(),i=J(),a={id:t,ids:{label:i==null?void 0:i.ids.label,input:i==null?void 0:i.ids.control},dir:n,disabled:i==null?void 0:i.disabled,invalid:i==null?void 0:i.invalid,readOnly:i==null?void 0:i.readOnly,required:i==null?void 0:i.required,getRootNode:r,...e},s=Se(Ge,a);return ze(s,ke)},le=h.forwardRef((e,t)=>{const[r,n]=G()(e,["activationMode","autoResize","defaultEdit","defaultValue","disabled","edit","finalFocusEl","form","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","submitMode","translations","value"]),i=Je(r),a=T(i.getRootProps(),n);return m.jsx(Z,{value:i,children:m.jsx(y.div,{...a,ref:t})})});le.displayName="EditableRoot";const ce=h.forwardRef((e,t)=>{const[{value:r},n]=G()(e,["value"]),i=T(r.getRootProps(),n);return m.jsx(Z,{value:r,children:m.jsx(y.div,{...i,ref:t})})});ce.displayName="EditableRootProvider";const fe=h.forwardRef((e,t)=>{const r=I(),n=T(r.getSubmitTriggerProps(),e);return m.jsx(y.button,{...n,ref:t})});fe.displayName="EditableSubmitTrigger";const{withProvider:ge,withContext:S,useStyles:lt,PropsProvider:Qe}=Ee({key:"editable"}),ct=ge(ce,"root",{forwardAsChild:!0}),ft=ge(le,"root",{forwardAsChild:!0}),gt=Qe,vt=S(ae,"preview",{forwardAsChild:!0}),pt=S(ne,"input",{forwardAsChild:!0}),Ze=h.forwardRef(function(t,r){const n=I(),i=be(n.getInputProps(),t);return m.jsx(y.textarea,{ref:r,...i})}),bt=S(Ze,"input",{forwardAsChild:!0}),Et=S(re,"control",{forwardAsChild:!0}),mt=S(ee,"area",{forwardAsChild:!0}),ht=S(ie,"editTrigger",{forwardAsChild:!0}),yt=S(fe,"submitTrigger",{forwardAsChild:!0}),Pt=S(te,"cancelTrigger",{forwardAsChild:!0}),wt=je;export{ft as E,vt as a,pt as b,Be as c,mt as d,Pt as e,wt as f,Et as g,ht as h,gt as i,ct as j,yt as k,bt as l,I as m,Je as n,$e as t,lt as u};
