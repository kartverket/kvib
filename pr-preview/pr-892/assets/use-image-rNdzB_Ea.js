import{r as u}from"./index-BwDkhjyp.js";import{u as S}from"./use-safe-layout-effect-BnICyLBj.js";function I(s){const{loading:e,src:o,srcSet:c,onLoad:t,onError:i,crossOrigin:l,sizes:f,ignoreFallback:d}=s,[g,m]=u.useState("pending");u.useEffect(()=>{m(o?"loading":"pending")},[o]);const n=u.useRef(),E=u.useCallback(()=>{if(!o)return;a();const r=new Image;r.src=o,l&&(r.crossOrigin=l),c&&(r.srcset=c),f&&(r.sizes=f),e&&(r.loading=e),r.onload=p=>{a(),m("loaded"),t==null||t(p)},r.onerror=p=>{a(),m("failed"),i==null||i(p)},n.current=r},[o,l,c,f,t,i,e]),a=()=>{n.current&&(n.current.onload=null,n.current.onerror=null,n.current=null)};return S(()=>{if(!d)return g==="loading"&&E(),()=>{a()}},[g,E,d]),d?"loaded":g}const O=(s,e)=>s!=="loaded"&&e==="beforeLoadOrError"||s==="failed"&&e==="onError";export{O as s,I as u};
