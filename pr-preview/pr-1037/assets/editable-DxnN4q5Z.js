import{j as E}from"./jsx-runtime-D_zvdyIk.js";import{h as B,m as O,a as w,j as pe}from"./factory-D4yCxYv5.js";import{r as h}from"./index-BqsZ9I6k.js";import{m as be}from"./factory-CLW_3um3.js";import{c as Ee}from"./create-slot-recipe-context-ChV7OG0U.js";import{r as A,g as me,b as he,i as ye,h as F,j as U,k as W,l as _,m as Pe,n as z,o as G,p as q,c as we,f as g,q as D,s as Ce,t as Te,u as Ie}from"./index-HrBoNtfU.js";import{c as Oe,a as J}from"./index-0TWAmYWa.js";import{c as Ve,u as Le,a as Se,n as ke}from"./index-CwUvXGRn.js";import{u as Re}from"./use-environment-context-C8ubon-d.js";import{u as Q}from"./use-field-context-BfGyb3zz.js";function xe(e){const t={each(r){var n;for(let i=0;i<((n=e.frames)==null?void 0:n.length);i+=1){const a=e.frames[i];a&&r(a)}},addEventListener(r,n,i){return t.each(a=>{try{a.document.addEventListener(r,n,i)}catch{}}),()=>{try{t.removeEventListener(r,n,i)}catch{}}},removeEventListener(r,n,i){t.each(a=>{try{a.document.removeEventListener(r,n,i)}catch{}})}};return t}function Ae(e){const t=e.frameElement!=null?e.parent:null;return{addEventListener:(r,n,i)=>{try{t==null||t.addEventListener(r,n,i)}catch{}return()=>{try{t==null||t.removeEventListener(r,n,i)}catch{}}},removeEventListener:(r,n,i)=>{try{t==null||t.removeEventListener(r,n,i)}catch{}}}}var Y="pointerdown.outside",X="focus.outside";function Ne(e){for(const t of e)if(z(t)&&_(t))return!0;return!1}var Z=e=>"clientY"in e;function De(e,t){if(!Z(t)||!e)return!1;const r=e.getBoundingClientRect();return r.width===0||r.height===0?!1:r.top<=t.clientY&&t.clientY<=r.top+r.height&&r.left<=t.clientX&&t.clientX<=r.left+r.width}function Me(e,t){return e.y<=t.y&&t.y<=e.y+e.height&&e.x<=t.x&&t.x<=e.x+e.width}function H(e,t){if(!t||!Z(e))return!1;const r=t.scrollHeight>t.clientHeight,n=r&&e.clientX>t.offsetLeft+t.clientWidth,i=t.scrollWidth>t.clientWidth,a=i&&e.clientY>t.offsetTop+t.clientHeight,s={x:t.offsetLeft,y:t.offsetTop,width:t.clientWidth+(r?16:0),height:t.clientHeight+(i?16:0)},C={x:e.clientX,y:e.clientY};return Me(s,C)?n||a:!1}function Fe(e,t){const{exclude:r,onFocusOutside:n,onPointerDownOutside:i,onInteractOutside:a,defer:s}=t;if(!e)return;const C=me(e),b=he(e),v=xe(b),S=Ae(b);function N(d,c){if(!z(c)||!c.isConnected||G(e,c)||De(e,d))return!1;const f=C.querySelector(`[aria-controls="${e.id}"]`);if(f){const p=q(f);if(H(d,p))return!1}const o=q(e);return H(d,o)?!1:!(r!=null&&r(c))}const m=new Set,y=ye(e==null?void 0:e.getRootNode());function u(d){function c(f){var T;const o=s&&!U()?A:k=>k(),p=f??d,x=((T=p==null?void 0:p.composedPath)==null?void 0:T.call(p))??[p==null?void 0:p.target];o(()=>{const k=y?x[0]:W(d);if(!(!e||!N(d,k))){if(i||a){const j=B(i,a);e.addEventListener(Y,j,{once:!0})}K(e,Y,{bubbles:!1,cancelable:!0,detail:{originalEvent:p,contextmenu:Pe(p),focusable:Ne(x),target:k}})}})}d.pointerType==="touch"?(m.forEach(f=>f()),m.add(F(C,"click",c,{once:!0})),m.add(S.addEventListener("click",c,{once:!0})),m.add(v.addEventListener("click",c,{once:!0}))):c()}const l=new Set,R=setTimeout(()=>{l.add(F(C,"pointerdown",u,!0)),l.add(S.addEventListener("pointerdown",u,!0)),l.add(v.addEventListener("pointerdown",u,!0))},0);function P(d){(s?A:f=>f())(()=>{const f=W(d);if(!(!e||!N(d,f))){if(n||a){const o=B(n,a);e.addEventListener(X,o,{once:!0})}K(e,X,{bubbles:!1,cancelable:!0,detail:{originalEvent:d,contextmenu:!1,focusable:_(f),target:f}})}})}return U()||(l.add(F(C,"focusin",P,!0)),l.add(S.addEventListener("focusin",P,!0)),l.add(v.addEventListener("focusin",P,!0))),()=>{clearTimeout(R),m.forEach(d=>d()),l.forEach(d=>d())}}function $e(e,t){const{defer:r}=t,n=r?A:a=>a(),i=[];return i.push(n(()=>{const a=typeof e=="function"?e():e;i.push(Fe(a,t))})),()=>{i.forEach(a=>a==null?void 0:a())}}function K(e,t,r){const n=e.ownerDocument.defaultView||window,i=new n.CustomEvent(t,r);return e.dispatchEvent(i)}const[ee,V]=we({name:"EditableContext",hookName:"useEditableContext",providerName:"<EditableProvider />"}),te=h.forwardRef((e,t)=>{const r=V(),n=O(r.getAreaProps(),e);return E.jsx(w.div,{...n,ref:t})});te.displayName="EditableArea";const re=h.forwardRef((e,t)=>{const r=V(),n=O(r.getCancelTriggerProps(),e);return E.jsx(w.button,{...n,ref:t})});re.displayName="EditableCancelTrigger";const je=e=>e.children(V()),ie=h.forwardRef((e,t)=>{const r=V(),n=O(r.getControlProps(),e);return E.jsx(w.div,{...n,ref:t})});ie.displayName="EditableControl";const ne=h.forwardRef((e,t)=>{const r=V(),n=O(r.getEditTriggerProps(),e);return E.jsx(w.button,{...n,ref:t})});ne.displayName="EditableEditTrigger";const ae=h.forwardRef((e,t)=>{const r=V(),n=O(r.getInputProps(),e),i=Q();return E.jsx(w.input,{"aria-describedby":i==null?void 0:i.ariaDescribedby,...n,ref:t})});ae.displayName="EditableInput";const oe=h.forwardRef((e,t)=>{const r=V(),n=O(r.getPreviewProps(),e);return E.jsx(w.span,{...n,ref:t})});oe.displayName="EditablePreview";var Be=Oe("editable").parts("root","area","label","preview","input","editTrigger","submitTrigger","cancelTrigger","control"),I=Be.build(),Ue=e=>{var t;return((t=e.ids)==null?void 0:t.root)??`editable:${e.id}`},We=e=>{var t;return((t=e.ids)==null?void 0:t.area)??`editable:${e.id}:area`},qe=e=>{var t;return((t=e.ids)==null?void 0:t.label)??`editable:${e.id}:label`},se=e=>{var t;return((t=e.ids)==null?void 0:t.preview)??`editable:${e.id}:preview`},$=e=>{var t;return((t=e.ids)==null?void 0:t.input)??`editable:${e.id}:input`},Ye=e=>{var t;return((t=e.ids)==null?void 0:t.control)??`editable:${e.id}:control`},de=e=>{var t;return((t=e.ids)==null?void 0:t.submitTrigger)??`editable:${e.id}:submit`},ue=e=>{var t;return((t=e.ids)==null?void 0:t.cancelTrigger)??`editable:${e.id}:cancel`},le=e=>{var t;return((t=e.ids)==null?void 0:t.editTrigger)??`editable:${e.id}:edit`},M=e=>e.getById($(e)),Xe=e=>e.getById(se(e)),He=e=>e.getById(de(e)),Ke=e=>e.getById(ue(e)),_e=e=>e.getById(le(e));function ze(e,t){const{state:r,context:n,send:i,prop:a,scope:s,computed:C}=e,b=!!a("disabled"),v=C("isInteractive"),S=!!a("readOnly"),N=!!a("required"),m=!!a("invalid"),y=!!a("autoResize"),u=a("translations"),l=r.matches("edit"),R=a("placeholder"),P=typeof R=="string"?{edit:R,preview:R}:R,d=n.get("value"),c=d.trim()==="",f=c?(P==null?void 0:P.preview)??"":d;return{editing:l,empty:c,value:d,valueText:f,setValue(o){i({type:"VALUE.SET",value:o,src:"setValue"})},clearValue(){i({type:"VALUE.SET",value:"",src:"clearValue"})},edit(){v&&i({type:"EDIT"})},cancel(){v&&i({type:"CANCEL"})},submit(){v&&i({type:"SUBMIT"})},getRootProps(){return t.element({...I.root.attrs,id:Ue(s),dir:a("dir")})},getAreaProps(){return t.element({...I.area.attrs,id:We(s),dir:a("dir"),style:y?{display:"inline-grid"}:void 0,"data-focus":g(l),"data-disabled":g(b),"data-placeholder-shown":g(c)})},getLabelProps(){return t.label({...I.label.attrs,id:qe(s),dir:a("dir"),htmlFor:$(s),"data-focus":g(l),"data-invalid":g(m),"data-required":g(N),onClick(){if(l)return;const o=Xe(s);o==null||o.focus({preventScroll:!0})}})},getInputProps(){return t.input({...I.input.attrs,dir:a("dir"),"aria-label":u==null?void 0:u.input,name:a("name"),form:a("form"),id:$(s),hidden:y?void 0:!l,placeholder:P==null?void 0:P.edit,maxLength:a("maxLength"),required:a("required"),disabled:b,"data-disabled":g(b),readOnly:S,"data-readonly":g(S),"aria-invalid":D(m),"data-invalid":g(m),"data-autoresize":g(y),defaultValue:d,size:y?1:void 0,onChange(o){i({type:"VALUE.SET",src:"input.change",value:o.currentTarget.value})},onKeyDown(o){if(o.defaultPrevented||Ce(o))return;const x={Escape(){i({type:"CANCEL"}),o.preventDefault()},Enter(T){if(!C("submitOnEnter"))return;const{localName:k}=T.currentTarget;if(k==="textarea"){if(!(Te()?T.metaKey:T.ctrlKey))return;i({type:"SUBMIT",src:"keydown.enter"});return}k==="input"&&!T.shiftKey&&!T.metaKey&&(i({type:"SUBMIT",src:"keydown.enter"}),T.preventDefault())}}[o.key];x&&x(o)},style:y?{gridArea:"1 / 1 / auto / auto",visibility:l?void 0:"hidden"}:void 0})},getPreviewProps(){return t.element({id:se(s),...I.preview.attrs,dir:a("dir"),"data-placeholder-shown":g(c),"aria-readonly":D(S),"data-readonly":g(b),"data-disabled":g(b),"aria-disabled":D(b),"aria-invalid":D(m),"data-invalid":g(m),"aria-label":u==null?void 0:u.edit,"data-autoresize":g(y),children:f,hidden:y?void 0:l,tabIndex:v?0:void 0,onClick(){v&&a("activationMode")==="click"&&i({type:"EDIT",src:"click"})},onFocus(){v&&a("activationMode")==="focus"&&i({type:"EDIT",src:"focus"})},onDoubleClick(o){o.defaultPrevented||v&&a("activationMode")==="dblclick"&&i({type:"EDIT",src:"dblclick"})},style:y?{whiteSpace:"pre",gridArea:"1 / 1 / auto / auto",visibility:l?"hidden":void 0,overflow:"hidden",textOverflow:"ellipsis"}:void 0})},getEditTriggerProps(){return t.button({...I.editTrigger.attrs,id:le(s),dir:a("dir"),"aria-label":u==null?void 0:u.edit,hidden:l,type:"button",disabled:b,onClick(o){o.defaultPrevented||v&&i({type:"EDIT",src:"edit.click"})}})},getControlProps(){return t.element({id:Ye(s),...I.control.attrs,dir:a("dir")})},getSubmitTriggerProps(){return t.button({...I.submitTrigger.attrs,dir:a("dir"),id:de(s),"aria-label":u==null?void 0:u.submit,hidden:!l,disabled:b,type:"button",onClick(o){o.defaultPrevented||v&&i({type:"SUBMIT",src:"submit.click"})}})},getCancelTriggerProps(){return t.button({...I.cancelTrigger.attrs,dir:a("dir"),"aria-label":u==null?void 0:u.cancel,id:ue(s),hidden:!l,type:"button",disabled:b,onClick(o){o.defaultPrevented||v&&i({type:"CANCEL",src:"cancel.click"})}})}}}var Ge=pe({props({props:e}){return{activationMode:"focus",submitMode:"both",defaultValue:"",selectOnFocus:!0,...e,translations:{input:"editable input",edit:"edit",submit:"submit",cancel:"cancel",...e.translations}}},initialState({prop:e}){return e("edit")||e("defaultEdit")?"edit":"preview"},entry:["focusInputIfNeeded"],context:({bindable:e,prop:t})=>({value:e(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange(r){var n;return(n=t("onValueChange"))==null?void 0:n({value:r})}})),previousValue:e(()=>({defaultValue:""}))}),watch({track:e,action:t,context:r,prop:n}){e([()=>r.get("value")],()=>{t(["syncInputValue"])}),e([()=>n("edit")],()=>{t(["toggleEditing"])})},computed:{submitOnEnter({prop:e}){const t=e("submitMode");return t==="both"||t==="enter"},submitOnBlur({prop:e}){const t=e("submitMode");return t==="both"||t==="blur"},isInteractive({prop:e}){return!(e("disabled")||e("readOnly"))}},on:{"VALUE.SET":{actions:["setValue"]}},states:{preview:{entry:["blurInputIfNeeded"],on:{"CONTROLLED.EDIT":{target:"edit",actions:["setPreviousValue","focusInput"]},EDIT:[{guard:"isEditControlled",actions:["invokeOnEdit"]},{target:"edit",actions:["setPreviousValue","focusInput","invokeOnEdit"]}]}},edit:{effects:["trackInteractOutside"],on:{"CONTROLLED.PREVIEW":[{guard:"isSubmitEvent",target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel"]}],CANCEL:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel","invokeOnPreview"]}],SUBMIT:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit","invokeOnPreview"]}]}}},implementations:{guards:{isEditControlled:({prop:e})=>e("edit")!=null,isSubmitEvent:({event:e})=>{var t;return((t=e.previousEvent)==null?void 0:t.type)==="SUBMIT"}},effects:{trackInteractOutside({send:e,scope:t,prop:r,computed:n}){return $e(M(t),{exclude(i){return[Ke(t),He(t)].some(s=>G(s,i))},onFocusOutside:r("onFocusOutside"),onPointerDownOutside:r("onPointerDownOutside"),onInteractOutside(i){var s;if((s=r("onInteractOutside"))==null||s(i),i.defaultPrevented)return;const{focusable:a}=i.detail;e({type:n("submitOnBlur")?"SUBMIT":"CANCEL",src:"interact-outside",focusable:a})}})}},actions:{restoreFocus({event:e,scope:t,prop:r}){e.focusable||A(()=>{var i;const n=((i=r("finalFocusEl"))==null?void 0:i())??_e(t);n==null||n.focus({preventScroll:!0})})},clearValue({context:e}){e.set("value","")},focusInputIfNeeded({action:e,prop:t}){(t("edit")||t("defaultEdit"))&&e(["focusInput"])},focusInput({scope:e,prop:t}){A(()=>{const r=M(e);r&&(t("selectOnFocus")?r.select():r.focus({preventScroll:!0}))})},invokeOnCancel({prop:e,context:t}){var n;const r=t.get("previousValue");(n=e("onValueRevert"))==null||n({value:r})},invokeOnSubmit({prop:e,context:t}){var n;const r=t.get("value");(n=e("onValueCommit"))==null||n({value:r})},invokeOnEdit({prop:e}){var t;(t=e("onEditChange"))==null||t({edit:!0})},invokeOnPreview({prop:e}){var t;(t=e("onEditChange"))==null||t({edit:!1})},toggleEditing({prop:e,send:t,event:r}){t({type:e("edit")?"CONTROLLED.EDIT":"CONTROLLED.PREVIEW",previousEvent:r})},syncInputValue({context:e,scope:t}){const r=M(t);r&&Ie(r,e.get("value"))},setValue({context:e,prop:t,event:r}){const n=t("maxLength"),i=n!=null?r.value.slice(0,n):r.value;e.set("value",i)},setPreviousValue({context:e}){e.set("previousValue",e.get("value"))},revertValue({context:e}){const t=e.get("previousValue");t&&e.set("value",t)},blurInputIfNeeded({scope:e}){var t;(t=M(e))==null||t.blur()}}}});Ve()(["activationMode","autoResize","dir","disabled","finalFocusEl","form","getRootNode","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","edit","defaultEdit","submitMode","translations","defaultValue","value"]);const Je=e=>{const t=h.useId(),{getRootNode:r}=Re(),{dir:n}=Le(),i=Q(),a={id:t,ids:{label:i==null?void 0:i.ids.label,input:i==null?void 0:i.ids.control},dir:n,disabled:i==null?void 0:i.disabled,invalid:i==null?void 0:i.invalid,readOnly:i==null?void 0:i.readOnly,required:i==null?void 0:i.required,getRootNode:r,...e},s=Se(Ge,a);return ze(s,ke)},ce=h.forwardRef((e,t)=>{const[r,n]=J()(e,["activationMode","autoResize","defaultEdit","defaultValue","disabled","edit","finalFocusEl","form","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","submitMode","translations","value"]),i=Je(r),a=O(i.getRootProps(),n);return E.jsx(ee,{value:i,children:E.jsx(w.div,{...a,ref:t})})});ce.displayName="EditableRoot";const fe=h.forwardRef((e,t)=>{const[{value:r},n]=J()(e,["value"]),i=O(r.getRootProps(),n);return E.jsx(ee,{value:r,children:E.jsx(w.div,{...i,ref:t})})});fe.displayName="EditableRootProvider";const ge=h.forwardRef((e,t)=>{const r=V(),n=O(r.getSubmitTriggerProps(),e);return E.jsx(w.button,{...n,ref:t})});ge.displayName="EditableSubmitTrigger";const{withProvider:ve,withContext:L,useStyles:lt,PropsProvider:Qe}=Ee({key:"editable"}),ct=ve(fe,"root",{forwardAsChild:!0}),ft=ve(ce,"root",{forwardAsChild:!0}),gt=Qe,vt=L(oe,"preview",{forwardAsChild:!0}),pt=L(ae,"input",{forwardAsChild:!0}),Ze=h.forwardRef(function(t,r){const n=V(),i=be(n.getInputProps(),t);return E.jsx(w.textarea,{ref:r,...i})}),bt=L(Ze,"input",{forwardAsChild:!0}),Et=L(ie,"control",{forwardAsChild:!0}),mt=L(te,"area",{forwardAsChild:!0}),ht=L(ne,"editTrigger",{forwardAsChild:!0}),yt=L(ge,"submitTrigger",{forwardAsChild:!0}),Pt=L(re,"cancelTrigger",{forwardAsChild:!0}),wt=je;export{ft as E,vt as a,pt as b,Be as c,mt as d,Pt as e,wt as f,Et as g,ht as h,gt as i,ct as j,yt as k,bt as l,V as m,Je as n,$e as t,lt as u};
