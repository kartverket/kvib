import{j as E}from"./jsx-runtime-D_zvdyIk.js";import{h as $,m as w,a as y,j as fe}from"./factory-R3eP5z4B.js";import{r as m}from"./index-Bj2TM2QZ.js";import{m as ge}from"./factory-BXJ64pFW.js";import{c as ve}from"./create-slot-recipe-context-L8Dqs-Z3.js";import{r as x,g as pe,b as be,e as D,f as X,h as j,j as Ee,k as H,l as K,m as B,c as me,n as v,o as A,p as he,q as ye,s as Pe}from"./create-context-CDNpEWXj.js";import{c as Ce,a as _}from"./index-BqWtAW9h.js";import{c as we,u as Te,a as Ie,n as Oe}from"./index-DT6T5u4j.js";import{u as Ve}from"./use-environment-context-I47z6LfF.js";import{u as z}from"./use-field-context-BdmdtcMn.js";function Le(e){const t={each(r){var n;for(let i=0;i<((n=e.frames)==null?void 0:n.length);i+=1){const a=e.frames[i];a&&r(a)}},addEventListener(r,n,i){return t.each(a=>{try{a.document.addEventListener(r,n,i)}catch{}}),()=>{try{t.removeEventListener(r,n,i)}catch{}}},removeEventListener(r,n,i){t.each(a=>{try{a.document.removeEventListener(r,n,i)}catch{}})}};return t}function ke(e){const t=e.frameElement!=null?e.parent:null;return{addEventListener:(r,n,i)=>{try{t==null||t.addEventListener(r,n,i)}catch{}return()=>{try{t==null||t.removeEventListener(r,n,i)}catch{}}},removeEventListener:(r,n,i)=>{try{t==null||t.removeEventListener(r,n,i)}catch{}}}}var U="pointerdown.outside",W="focus.outside";function Se(e){for(const t of e)if(H(t)&&X(t))return!0;return!1}var G=e=>"clientY"in e;function Re(e,t){if(!G(t)||!e)return!1;const r=e.getBoundingClientRect();return r.width===0||r.height===0?!1:r.top<=t.clientY&&t.clientY<=r.top+r.height&&r.left<=t.clientX&&t.clientX<=r.left+r.width}function xe(e,t){return e.y<=t.y&&t.y<=e.y+e.height&&e.x<=t.x&&t.x<=e.x+e.width}function q(e,t){if(!t||!G(e))return!1;const r=t.scrollHeight>t.clientHeight,n=r&&e.clientX>t.offsetLeft+t.clientWidth,i=t.scrollWidth>t.clientWidth,a=i&&e.clientY>t.offsetTop+t.clientHeight,d={x:t.offsetLeft,y:t.offsetTop,width:t.clientWidth+(r?16:0),height:t.clientHeight+(i?16:0)},P={x:e.clientX,y:e.clientY};return xe(d,P)?n||a:!1}function Ae(e,t){const{exclude:r,onFocusOutside:n,onPointerDownOutside:i,onInteractOutside:a,defer:d}=t;if(!e)return;const P=pe(e),b=be(e),f=Le(b),V=ke(b);function I(o){const c=j(o);if(!H(c)||!c.isConnected||K(e,c)||Re(e,o))return!1;const p=P.querySelector(`[aria-controls="${e.id}"]`);if(p){const R=B(p);if(q(o,R))return!1}const s=B(e);return q(o,s)?!1:!(r!=null&&r(c))}const g=new Set;function u(o){function c(){var R;const p=d?x:k=>k(),s=((R=o.composedPath)==null?void 0:R.call(o))??[o.target];p(()=>{if(!(!e||!I(o))){if(i||a){const k=$(i,a);e.addEventListener(U,k,{once:!0})}Y(e,U,{bubbles:!1,cancelable:!0,detail:{originalEvent:o,contextmenu:Ee(o),focusable:Se(s)}})}})}o.pointerType==="touch"?(g.forEach(p=>p()),g.add(D(P,"click",c,{once:!0})),g.add(V.addEventListener("click",c,{once:!0})),g.add(f.addEventListener("click",c,{once:!0}))):c()}const l=new Set,L=setTimeout(()=>{l.add(D(P,"pointerdown",u,!0)),l.add(V.addEventListener("pointerdown",u,!0)),l.add(f.addEventListener("pointerdown",u,!0))},0);function h(o){(d?x:p=>p())(()=>{if(!(!e||!I(o))){if(n||a){const p=$(n,a);e.addEventListener(W,p,{once:!0})}Y(e,W,{bubbles:!1,cancelable:!0,detail:{originalEvent:o,contextmenu:!1,focusable:X(j(o))}})}})}return l.add(D(P,"focusin",h,!0)),l.add(V.addEventListener("focusin",h,!0)),l.add(f.addEventListener("focusin",h,!0)),()=>{clearTimeout(L),g.forEach(o=>o()),l.forEach(o=>o())}}function Ne(e,t){const{defer:r}=t,n=r?x:a=>a(),i=[];return i.push(n(()=>{const a=typeof e=="function"?e():e;i.push(Ae(a,t))})),()=>{i.forEach(a=>a==null?void 0:a())}}function Y(e,t,r){const n=e.ownerDocument.defaultView||window,i=new n.CustomEvent(t,r);return e.dispatchEvent(i)}const[J,T]=me({name:"EditableContext",hookName:"useEditableContext",providerName:"<EditableProvider />"}),Q=m.forwardRef((e,t)=>{const r=T(),n=w(r.getAreaProps(),e);return E.jsx(y.div,{...n,ref:t})});Q.displayName="EditableArea";const Z=m.forwardRef((e,t)=>{const r=T(),n=w(r.getCancelTriggerProps(),e);return E.jsx(y.button,{...n,ref:t})});Z.displayName="EditableCancelTrigger";const De=e=>e.children(T()),ee=m.forwardRef((e,t)=>{const r=T(),n=w(r.getControlProps(),e);return E.jsx(y.div,{...n,ref:t})});ee.displayName="EditableControl";const te=m.forwardRef((e,t)=>{const r=T(),n=w(r.getEditTriggerProps(),e);return E.jsx(y.button,{...n,ref:t})});te.displayName="EditableEditTrigger";const re=m.forwardRef((e,t)=>{const r=T(),n=w(r.getInputProps(),e),i=z();return E.jsx(y.input,{"aria-describedby":i==null?void 0:i.ariaDescribedby,...n,ref:t})});re.displayName="EditableInput";const ie=m.forwardRef((e,t)=>{const r=T(),n=w(r.getPreviewProps(),e);return E.jsx(y.span,{...n,ref:t})});ie.displayName="EditablePreview";var Me=Ce("editable").parts("root","area","label","preview","input","editTrigger","submitTrigger","cancelTrigger","control"),C=Me.build(),Fe=e=>{var t;return((t=e.ids)==null?void 0:t.root)??`editable:${e.id}`},$e=e=>{var t;return((t=e.ids)==null?void 0:t.area)??`editable:${e.id}:area`},je=e=>{var t;return((t=e.ids)==null?void 0:t.label)??`editable:${e.id}:label`},ne=e=>{var t;return((t=e.ids)==null?void 0:t.preview)??`editable:${e.id}:preview`},M=e=>{var t;return((t=e.ids)==null?void 0:t.input)??`editable:${e.id}:input`},Be=e=>{var t;return((t=e.ids)==null?void 0:t.control)??`editable:${e.id}:control`},ae=e=>{var t;return((t=e.ids)==null?void 0:t.submitTrigger)??`editable:${e.id}:submit`},oe=e=>{var t;return((t=e.ids)==null?void 0:t.cancelTrigger)??`editable:${e.id}:cancel`},se=e=>{var t;return((t=e.ids)==null?void 0:t.editTrigger)??`editable:${e.id}:edit`},N=e=>e.getById(M(e)),Ue=e=>e.getById(ne(e)),We=e=>e.getById(ae(e)),qe=e=>e.getById(oe(e)),Ye=e=>e.getById(se(e));function Xe(e,t){const{state:r,context:n,send:i,prop:a,scope:d,computed:P}=e,b=a("disabled"),f=P("isInteractive"),V=a("readOnly"),I=a("invalid"),g=a("autoResize"),u=a("translations"),l=r.matches("edit"),L=a("placeholder"),h=typeof L=="string"?{edit:L,preview:L}:L,o=n.get("value"),c=o.trim()==="",p=c?(h==null?void 0:h.preview)??"":o;return{editing:l,empty:c,value:o,valueText:p,setValue(s){i({type:"VALUE.SET",value:s,src:"setValue"})},clearValue(){i({type:"VALUE.SET",value:"",src:"clearValue"})},edit(){f&&i({type:"EDIT"})},cancel(){f&&i({type:"CANCEL"})},submit(){f&&i({type:"SUBMIT"})},getRootProps(){return t.element({...C.root.attrs,id:Fe(d),dir:a("dir")})},getAreaProps(){return t.element({...C.area.attrs,id:$e(d),dir:a("dir"),style:g?{display:"inline-grid"}:void 0,"data-focus":v(l),"data-disabled":v(b),"data-placeholder-shown":v(c)})},getLabelProps(){return t.label({...C.label.attrs,id:je(d),dir:a("dir"),htmlFor:M(d),"data-focus":v(l),"data-invalid":v(I),onClick(){if(l)return;const s=Ue(d);s==null||s.focus({preventScroll:!0})}})},getInputProps(){return t.input({...C.input.attrs,dir:a("dir"),"aria-label":u==null?void 0:u.input,name:a("name"),form:a("form"),id:M(d),hidden:g?void 0:!l,placeholder:h==null?void 0:h.edit,maxLength:a("maxLength"),required:a("required"),disabled:b,"data-disabled":v(b),readOnly:V,"data-readonly":v(V),"aria-invalid":A(I),"data-invalid":v(I),"data-autoresize":v(g),defaultValue:o,size:g?1:void 0,onChange(s){i({type:"VALUE.SET",src:"input.change",value:s.currentTarget.value})},onKeyDown(s){if(s.defaultPrevented||he(s))return;const k={Escape(){i({type:"CANCEL"}),s.preventDefault()},Enter(S){if(!P("submitOnEnter"))return;const{localName:F}=S.currentTarget;if(F==="textarea"){if(!(ye()?S.metaKey:S.ctrlKey))return;i({type:"SUBMIT",src:"keydown.enter"});return}F==="input"&&!S.shiftKey&&!S.metaKey&&(i({type:"SUBMIT",src:"keydown.enter"}),S.preventDefault())}}[s.key];k&&k(s)},style:g?{gridArea:"1 / 1 / auto / auto",visibility:l?void 0:"hidden"}:void 0})},getPreviewProps(){return t.element({id:ne(d),...C.preview.attrs,dir:a("dir"),"data-placeholder-shown":v(c),"aria-readonly":A(V),"data-readonly":v(b),"data-disabled":v(b),"aria-disabled":A(b),"aria-invalid":A(I),"data-invalid":v(I),"aria-label":u==null?void 0:u.edit,"data-autoresize":v(g),children:p,hidden:g?void 0:l,tabIndex:f?0:void 0,onClick(){f&&a("activationMode")==="click"&&i({type:"EDIT",src:"click"})},onFocus(){f&&a("activationMode")==="focus"&&i({type:"EDIT",src:"focus"})},onDoubleClick(s){s.defaultPrevented||f&&a("activationMode")==="dblclick"&&i({type:"EDIT",src:"dblclick"})},style:g?{whiteSpace:"pre",userSelect:"none",gridArea:"1 / 1 / auto / auto",visibility:l?"hidden":void 0,overflow:"hidden",textOverflow:"ellipsis"}:void 0})},getEditTriggerProps(){return t.button({...C.editTrigger.attrs,id:se(d),dir:a("dir"),"aria-label":u==null?void 0:u.edit,hidden:l,type:"button",disabled:b,onClick(s){s.defaultPrevented||f&&i({type:"EDIT",src:"edit.click"})}})},getControlProps(){return t.element({id:Be(d),...C.control.attrs,dir:a("dir")})},getSubmitTriggerProps(){return t.button({...C.submitTrigger.attrs,dir:a("dir"),id:ae(d),"aria-label":u==null?void 0:u.submit,hidden:!l,disabled:b,type:"button",onClick(s){s.defaultPrevented||f&&i({type:"SUBMIT",src:"submit.click"})}})},getCancelTriggerProps(){return t.button({...C.cancelTrigger.attrs,dir:a("dir"),"aria-label":u==null?void 0:u.cancel,id:oe(d),hidden:!l,type:"button",disabled:b,onClick(s){s.defaultPrevented||f&&i({type:"CANCEL",src:"cancel.click"})}})}}}var He=fe({props({props:e}){return{activationMode:"focus",submitMode:"both",defaultValue:"",selectOnFocus:!0,...e,translations:{input:"editable input",edit:"edit",submit:"submit",cancel:"cancel",...e.translations}}},initialState({prop:e}){return e("edit")||e("defaultEdit")?"edit":"preview"},entry:["focusInputIfNeeded"],context:({bindable:e,prop:t})=>({value:e(()=>({defaultValue:t("defaultValue"),value:t("value"),onChange(r){var n;return(n=t("onValueChange"))==null?void 0:n({value:r})}})),previousValue:e(()=>({defaultValue:""}))}),watch({track:e,action:t,context:r,prop:n}){e([()=>r.get("value")],()=>{t(["syncInputValue"])}),e([()=>n("edit")],()=>{t(["toggleEditing"])})},computed:{submitOnEnter({prop:e}){return["both","enter"].includes(e("submitMode"))},submitOnBlur({prop:e}){return["both","blur"].includes(e("submitMode"))},isInteractive({prop:e}){return!(e("disabled")||e("readOnly"))}},on:{"VALUE.SET":{actions:["setValue"]}},states:{preview:{entry:["blurInputIfNeeded"],on:{"CONTROLLED.EDIT":{target:"edit",actions:["setPreviousValue","focusInput"]},EDIT:[{guard:"isEditControlled",actions:["invokeOnEdit"]},{target:"edit",actions:["setPreviousValue","focusInput","invokeOnEdit"]}]}},edit:{effects:["trackInteractOutside"],on:{"CONTROLLED.PREVIEW":[{guard:"isSubmitEvent",target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel"]}],CANCEL:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["revertValue","restoreFocus","invokeOnCancel","invokeOnPreview"]}],SUBMIT:[{guard:"isEditControlled",actions:["invokeOnPreview"]},{target:"preview",actions:["setPreviousValue","restoreFocus","invokeOnSubmit","invokeOnPreview"]}]}}},implementations:{guards:{isEditControlled:({prop:e})=>e("edit")!=null,isSubmitEvent:({event:e})=>{var t;return((t=e.previousEvent)==null?void 0:t.type)==="SUBMIT"}},effects:{trackInteractOutside({send:e,scope:t,prop:r,computed:n}){return Ne(N(t),{exclude(i){return[qe(t),We(t)].some(d=>K(d,i))},onFocusOutside:r("onFocusOutside"),onPointerDownOutside:r("onPointerDownOutside"),onInteractOutside(i){var d;if((d=r("onInteractOutside"))==null||d(i),i.defaultPrevented)return;const{focusable:a}=i.detail;e({type:n("submitOnBlur")?"SUBMIT":"CANCEL",src:"interact-outside",focusable:a})}})}},actions:{restoreFocus({event:e,scope:t,prop:r}){e.focusable||x(()=>{var i;const n=((i=r("finalFocusEl"))==null?void 0:i())??Ye(t);n==null||n.focus({preventScroll:!0})})},clearValue({context:e}){e.set("value","")},focusInputIfNeeded({action:e,prop:t}){(t("edit")||t("defaultEdit"))&&e(["focusInput"])},focusInput({scope:e,prop:t}){x(()=>{const r=N(e);r&&(t("selectOnFocus")?r.select():r.focus({preventScroll:!0}))})},invokeOnCancel({prop:e,context:t}){var n;const r=t.get("previousValue");(n=e("onValueRevert"))==null||n({value:r})},invokeOnSubmit({prop:e,context:t}){var n;const r=t.get("value");(n=e("onValueCommit"))==null||n({value:r})},invokeOnEdit({prop:e}){var t;(t=e("onEditChange"))==null||t({edit:!0})},invokeOnPreview({prop:e}){var t;(t=e("onEditChange"))==null||t({edit:!1})},toggleEditing({prop:e,send:t,event:r}){t({type:e("edit")?"CONTROLLED.EDIT":"CONTROLLED.PREVIEW",previousEvent:r})},syncInputValue({context:e,scope:t}){const r=N(t);r&&Pe(r,e.get("value"))},setValue({context:e,prop:t,event:r}){const n=t("maxLength"),i=n!=null?r.value.slice(0,n):r.value;e.set("value",i)},setPreviousValue({context:e}){e.set("previousValue",e.get("value"))},revertValue({context:e}){const t=e.get("previousValue");t&&e.set("value",t)},blurInputIfNeeded({scope:e}){var t;(t=N(e))==null||t.blur()}}}});we()(["activationMode","autoResize","dir","disabled","finalFocusEl","form","getRootNode","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","edit","defaultEdit","submitMode","translations","defaultValue","value"]);const Ke=e=>{const t=m.useId(),{getRootNode:r}=Ve(),{dir:n}=Te(),i=z(),a={id:t,ids:{label:i==null?void 0:i.ids.label,input:i==null?void 0:i.ids.control},dir:n,disabled:i==null?void 0:i.disabled,invalid:i==null?void 0:i.invalid,readOnly:i==null?void 0:i.readOnly,required:i==null?void 0:i.required,getRootNode:r,...e},d=Ie(He,a);return Xe(d,Oe)},de=m.forwardRef((e,t)=>{const[r,n]=_()(e,["activationMode","autoResize","defaultEdit","defaultValue","disabled","edit","finalFocusEl","form","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","submitMode","translations","value"]),i=Ke(r),a=w(i.getRootProps(),n);return E.jsx(J,{value:i,children:E.jsx(y.div,{...a,ref:t})})});de.displayName="EditableRoot";const ue=m.forwardRef((e,t)=>{const[{value:r},n]=_()(e,["value"]),i=w(r.getRootProps(),n);return E.jsx(J,{value:r,children:E.jsx(y.div,{...i,ref:t})})});ue.displayName="EditableRootProvider";const le=m.forwardRef((e,t)=>{const r=T(),n=w(r.getSubmitTriggerProps(),e);return E.jsx(y.button,{...n,ref:t})});le.displayName="EditableSubmitTrigger";const{withProvider:ce,withContext:O,useStyles:st,PropsProvider:_e}=ve({key:"editable"}),dt=ce(ue,"root",{forwardAsChild:!0}),ut=ce(de,"root",{forwardAsChild:!0}),lt=_e,ct=O(ie,"preview",{forwardAsChild:!0}),ft=O(re,"input",{forwardAsChild:!0}),ze=m.forwardRef(function(t,r){const n=T(),i=ge(n.getInputProps(),t);return E.jsx(y.textarea,{ref:r,...i})}),gt=O(ze,"input",{forwardAsChild:!0}),vt=O(ee,"control",{forwardAsChild:!0}),pt=O(Q,"area",{forwardAsChild:!0}),bt=O(te,"editTrigger",{forwardAsChild:!0}),Et=O(le,"submitTrigger",{forwardAsChild:!0}),mt=O(Z,"cancelTrigger",{forwardAsChild:!0}),ht=De;export{ut as E,ct as a,ft as b,Me as c,pt as d,mt as e,ht as f,vt as g,bt as h,lt as i,dt as j,Et as k,gt as l,T as m,Ke as n,Ne as t,st as u};
