import { Meta } from "@storybook/blocks";
import { Alert, AlertIcon } from "@kvib/react/src";

<Meta title="Info/Bidra/Publish" />

# Oppdatere npm-pakken og changelog

Når komponenten er testet både for oppførsel og UU, kan den merges med master, og legges til i npm-pakken.
Det er viktig å ha en god changelog for at brukere enkelt skal kunne se om endringer av pakken påvirker komponenter de eventuelt har tatt i bruk i egne prosjekt.

{" "}

<Alert status="info">
  <AlertIcon />
  Stegene under gjennomføres kun for å publisere nye endringer i NPM-pakken (packages/react). Dersom du bare har gjort endringer
  i apps/storybook mappen blir disse automatisk publisert med github-pages, og du trenger ikke foreta deg noe mer.
</Alert>

Under følger noen kjennetegn for versjonsoppdatering: (Informasjonen er hentet fra [Major.Minor.Patch artikkelen](https://medium.com/fiverr-engineering/major-minor-patch-a5298e2e1798))

- **patch**: ved interne fixes, eksempelvis bug fix, forbedrelse av performance, enviroment eller andre interne tweaks. Hovedregel: Bruker _burde_ oppdatere pakken uten å nøle.
- **minor**: når interfacet endrer seg, men har **mulighet** til å rulle tilbake til tidligere versjoner. Eksempelvis ved nye funksjoner, komponenter, nye tilgjengelige props osv.
  Hovedregel: Bruker oppdaterer pakke for å få nye funksjoner, uten at noe vil kræsje.
- **major**: når interfacet endrer seg, men har **ikke mulighet** til å rulle tilbake til tidligere versjoner. Eksempelvis endrer API endpoint navn eller signatur.
  Hovedregel: test systemet nøye etter oppdatering.

Slik gjør du det:

1.  Kjør `npx changeset`. Det vil komme opp valg du må gjøre i terminal for å velge versjon-oppdatering av npm-pakken.
2.  Bruk piltaster og space til å velge @kvib/react, som er den pakken vi ønsker å oppdatere (grønn stjerne viser at den er valgt). Trykk deretter enter for å komme videre.

<img alt="changeset- set package to include" src={require("../../../public/assets/changeset1.png")} />

3.  Du får videre valget om oppdateringen skal være av typen _major_. Hvis ja- bruk piltaster og enter til å velge riktig pakke. Hvis nei- trykk enter med engang uten å velge pakke.
    <img alt="changeset- set major bump" src={require("../../../public/assets/changeset2.png")} />
4.  Videre setter du oppdatering av typen minor. Bruk piltaster og enter til å velge riktig pakke.
    <img alt="changeset- set minor bump" src={require("../../../public/assets/changeset3.png")} />
5.  Tilslutt skriver du oppsummering av oppdateringen som er gjort av pakken.
    <img alt="changeset- set summary" src={require("../../../public/assets/changeset4.png")} />
6.  I mappen _changeset_ vil det nå automatisk legges til en fil med et tilfeldig generert navn. Der kan du redigere _summary_ som du skrev av oppdateringen.
    Det er særlig viktig at kritiske endringer blir dokumentert, f.eks. dersom gyldig verdier til en prop endres. Under er et eksempel på changelog av Button-komponenten:

        ```jsx

        Button-komponent er tilgjengelig med Kartverkets Design. Dokumentasjon er oppdatert. Kritiske endringer:
         -**colorScheme** tar verdiene: "green" (default), "blue", "gray", "red".
         -**rightIcon**/ **leftIcon**: er av typen String, ikke lenger et element.

        ```
